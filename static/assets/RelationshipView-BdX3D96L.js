import{ab as T,a as as,r as v,p as ns,P as Cs,I as Vs,c as d,e as s,g as x,Y as P,$ as ts,F as A,h as j,Z as L,t as a,o as i,_ as is,b as $s,G as Ps,f as N,a0 as Rs,n as F,v as Y,w as U,T as O,x as Z,m as Ss,ap as Es,a8 as os}from"./index-seK3UZHU.js";import{b as K,a as H}from"./dialog-CJxjYzKp.js";import"./index-B-U4Ta6B.js";import{i as Is}from"./install-C00Tj0d-.js";import"./ConfirmDialog-CcsY9AOv.js";import"./iconify-CkHa40tq.js";async function J(){return await T.get("relationship/platforms")}async function X(r=1,n=20,p){let h=`relationship/list?page=${r}&page_size=${n}`;return p&&(h+=`&platform=${encodeURIComponent(p)}`),await T.get(h)}async function rs(r){return await T.get(`relationship/person/${r}`)}async function ds(r,n){return await T.put(`relationship/person/${r}`,n)}async function us(r){return await T.get(`relationship/search?query=${encodeURIComponent(r)}`)}async function Ds(r,n,p){return await T.put(`relationship/person/${r}/impression`,{impression:n||null,short_impression:p||null})}async function zs(r,n){return await T.put(`relationship/person/${r}/points`,n)}const ls=Object.freeze(Object.defineProperty({__proto__:null,getPersonDetail:rs,getPersonList:X,getPlatforms:J,searchPerson:us,updatePersonImpression:Ds,updatePersonPoints:zs,updatePersonRelationship:ds},Symbol.toStringTag,{value:"Module"}));function Ms(r){const n=r.split(":");return n.length>1&&n[0]?n[0]:"unknown"}function cs(r){const n={qq:"#12B7F5",wechat:"#07C160",web_ui_chatroom:"#6366F1",telegram:"#0088CC",discord:"#5865F2",default:"#94A3B8"};return n[r]||n.default}function Fs(r){const h=30+r/10;return Math.min(h,80)}function Ls(r){return r>.7?"#10B981":r>.4?"#F59E0B":"#94A3B8"}function Ns(r,n){const p=(r.relationship_score+n.relationship_score)/2,h=r.platform===n.platform?.1:0,c=Math.min((r.know_times+n.know_times)/500,.2);return Math.min(p+h+c,1)}function Us(r){return r.map(n=>{const p=Ms(n.person_id);return{id:n.person_id,name:n.nickname||n.person_name,platform:p,relationship_score:n.relationship_score,know_times:n.know_times,category:p,symbolSize:Fs(n.know_times),itemStyle:{color:cs(p)},label:{show:!0}}})}function Ts(r,n=5,p=.3){const h=[],c=new Set;for(const m of r){const k=[];for(const f of r){if(m.id===f.id)continue;const g=Ns(m,f);g>=p&&k.push({target:f,strength:g})}k.sort((f,g)=>g.strength-f.strength),k.slice(0,n).forEach(({target:f,strength:g})=>{const y=[m.id,f.id].sort().join("-");c.has(y)||(c.add(y),h.push({source:m.id,target:f.id,value:g,lineStyle:{width:g*5,color:Ls(g),type:g>.6?"solid":"dashed"}}))})}return h}function Bs(r){const n=new Set(r.map(p=>p.platform));return Array.from(n).map(p=>({name:p,itemStyle:{color:cs(p)}}))}function Gs(r,n){const p=r.length,h=n.length,c=p>0?r.reduce((y,D)=>y+D.relationship_score,0)/p:0,m=p>0?Math.max(...r.map(y=>y.relationship_score)):0,k=p>0?Math.min(...r.map(y=>y.relationship_score)):0,f=new Set;n.forEach(y=>{f.add(y.source),f.add(y.target)});const g=r.filter(y=>!f.has(y.id)).length;return{total_nodes:p,total_edges:h,avg_score:c,max_score:m,min_score:k,isolated_nodes:g}}const Os={class:"relationship-graph"},As={class:"graph-controls"},js={class:"control-group"},qs=["value"],Ks={class:"control-group"},Ws={class:"score-value"},Qs={class:"control-group"},Ys={class:"graph-stats"},Zs={class:"stat-item"},Hs={class:"stat-value"},Js={class:"stat-item"},Xs={class:"stat-value"},se={class:"stat-item"},ee={class:"stat-value"},te={class:"stat-item"},oe={class:"stat-value"},le={key:0,class:"loading-overlay"},ae=as({__name:"RelationshipGraph",props:{centerPersonId:{}},emits:["nodeClick"],setup(r,{emit:n}){const p=r,h=n,c=v(),m=v(),k=v(!1),f=v([]),g=v([]),y=v([]),D=v(""),z=v(0),R=v("force"),C=v({total_nodes:0,total_edges:0,avg_score:0,max_score:0,min_score:0,isolated_nodes:0});async function B(){k.value=!0;try{const l=await J();l.success&&l.data&&(y.value=l.data.platforms);const u=await X(1,200,D.value||void 0);if(u.success&&u.data){const b=u.data.persons.filter($=>$.relationship_score>=z.value/100);f.value=Us(b),g.value=Ts(f.value,5,.3),C.value=Gs(f.value,g.value),S()}}catch(l){console.error("åŠ è½½å›¾è°±æ•°æ®å¤±è´¥:",l)}finally{k.value=!1}}function S(){if(!c.value)return;m.value||(m.value=Is(c.value));const l=Bs(f.value),u={title:{text:"å…³ç³»å›¾è°±",left:"center",top:10,textStyle:{color:"var(--md-sys-color-on-surface)",fontSize:18,fontWeight:500}},tooltip:{formatter:b=>{if(b.dataType==="node"){const $=b.data;return`
            <div style="padding: 8px;">
              <strong style="font-size: 14px;">${$.name}</strong><br/>
              <span style="color: #666;">å¹³å°: ${$.platform}</span><br/>
              <span style="color: #666;">å…³ç³»åˆ†æ•°: ${($.relationship_score*100).toFixed(0)}%</span><br/>
              <span style="color: #666;">äº¤äº’æ¬¡æ•°: ${$.know_times}</span>
            </div>
          `}else if(b.dataType==="edge")return`å…³ç³»å¼ºåº¦: ${(b.data.value*100).toFixed(0)}%`;return""},backgroundColor:"var(--md-sys-color-surface-container-high)",borderColor:"var(--md-sys-color-outline)",textStyle:{color:"var(--md-sys-color-on-surface)"}},legend:{data:l.map(b=>b.name),orient:"vertical",left:10,top:50,textStyle:{color:"var(--md-sys-color-on-surface)"}},series:[{type:"graph",layout:R.value,data:f.value,links:g.value,categories:l,roam:!0,label:{show:!0,position:"right",formatter:"{b}",fontSize:12,color:"var(--md-sys-color-on-surface)"},labelLayout:{hideOverlap:!0},scaleLimit:{min:.4,max:2},lineStyle:{color:"source",curveness:.3},emphasis:{focus:"adjacency",lineStyle:{width:10},label:{fontSize:14,fontWeight:"bold"}},force:R.value==="force"?{repulsion:100,edgeLength:[50,200],gravity:.1,friction:.6}:void 0,circular:R.value==="circular"?{rotateLabel:!0}:void 0}]};m.value.setOption(u),m.value.off("click"),m.value.on("click",b=>{b.dataType==="node"&&h("nodeClick",b.data.id)})}function V(){B()}function E(){S()}function I(){m.value&&m.value.dispatchAction({type:"restore"})}function _(){var l;(l=m.value)==null||l.resize()}return ns(()=>{B(),window.addEventListener("resize",_)}),Cs(()=>{var l;window.removeEventListener("resize",_),(l=m.value)==null||l.dispose()}),Vs(()=>p.centerPersonId,()=>{p.centerPersonId&&B()}),(l,u)=>(i(),d("div",Os,[s("div",As,[s("div",js,[u[4]||(u[4]=s("label",{class:"control-label"},[s("span",{class:"material-symbols-rounded"},"filter_list"),s("span",null,"å¹³å°ç­›é€‰")],-1)),P(s("select",{"onUpdate:modelValue":u[0]||(u[0]=b=>D.value=b),class:"m3-select",onChange:V},[u[3]||(u[3]=s("option",{value:""},"å…¨éƒ¨å¹³å°",-1)),(i(!0),d(A,null,j(y.value,b=>(i(),d("option",{key:b.platform,value:b.platform},a(b.platform)+" ("+a(b.count)+") ",9,qs))),128))],544),[[ts,D.value]])]),s("div",Ks,[u[5]||(u[5]=s("label",{class:"control-label"},[s("span",{class:"material-symbols-rounded"},"tune"),s("span",null,"æœ€å°å…³ç³»åˆ†æ•°")],-1)),P(s("input",{"onUpdate:modelValue":u[1]||(u[1]=b=>z.value=b),type:"range",min:"0",max:"100",class:"m3-slider",onChange:V},null,544),[[L,z.value,void 0,{number:!0}]]),s("span",Ws,a(z.value)+"%",1)]),s("div",Qs,[u[7]||(u[7]=s("label",{class:"control-label"},[s("span",{class:"material-symbols-rounded"},"account_tree"),s("span",null,"å¸ƒå±€")],-1)),P(s("select",{"onUpdate:modelValue":u[2]||(u[2]=b=>R.value=b),class:"m3-select",onChange:E},[...u[6]||(u[6]=[s("option",{value:"force"},"åŠ›å¯¼å‘å¸ƒå±€",-1),s("option",{value:"circular"},"ç¯å½¢å¸ƒå±€",-1)])],544),[[ts,R.value]])]),s("button",{class:"m3-button text",onClick:I},[...u[8]||(u[8]=[s("span",{class:"material-symbols-rounded"},"refresh",-1),s("span",null,"é‡ç½®è§†å›¾",-1)])])]),s("div",{class:"graph-canvas",ref_key:"chartContainer",ref:c},null,512),s("div",Ys,[s("div",Zs,[u[9]||(u[9]=s("span",{class:"stat-label"},"èŠ‚ç‚¹æ•°",-1)),s("span",Hs,a(C.value.total_nodes),1)]),s("div",Js,[u[10]||(u[10]=s("span",{class:"stat-label"},"å…³ç³»æ•°",-1)),s("span",Xs,a(C.value.total_edges),1)]),s("div",se,[u[11]||(u[11]=s("span",{class:"stat-label"},"å¹³å‡åˆ†æ•°",-1)),s("span",ee,a((C.value.avg_score*100).toFixed(0))+"%",1)]),s("div",te,[u[12]||(u[12]=s("span",{class:"stat-label"},"å­¤ç«‹èŠ‚ç‚¹",-1)),s("span",oe,a(C.value.isolated_nodes),1)])]),k.value?(i(),d("div",le,[...u[13]||(u[13]=[s("span",{class:"material-symbols-rounded spinning"},"progress_activity",-1),s("p",null,"åŠ è½½å›¾è°±æ•°æ®...",-1)])])):x("",!0)]))}}),ne=is(ae,[["__scopeId","data-v-3851374e"]]),ie={class:"relationship-view"},re={key:0,class:"top-bar"},de={key:1,class:"search-bar-container"},ue={key:2,class:"loading-state"},ce={key:3,class:"error-state"},pe={key:4,class:"person-detail"},me={class:"m3-card info-card"},ve={class:"card-body"},fe={class:"info-grid"},he={class:"info-item"},be={class:"value"},ye={class:"info-item"},_e={class:"value"},ge={class:"info-item"},we={class:"value"},ke={class:"info-item"},xe={class:"value"},Ce={class:"info-item full-width"},Ve={class:"value"},$e={class:"info-item full-width"},Pe={class:"value"},Re={class:"m3-card info-card"},Se={class:"card-body"},Ee={class:"relationship-score"},Ie={class:"score-bar-container"},De={class:"score-bar"},ze={class:"score-text"},Me={class:"relationship-text"},Fe={class:"m3-card info-card"},Le={class:"card-body"},Ne={class:"impression-section"},Ue={class:"impression-text"},Te={class:"impression-section"},Be={class:"impression-text short"},Ge={class:"m3-card info-card"},Oe={class:"card-body"},Ae={key:0,class:"empty-state"},je={key:1,class:"memory-points-list"},qe={class:"point-header"},Ke={class:"point-weight"},We={class:"point-time"},Qe={class:"point-content"},Ye={key:5,class:"person-list"},Ze={class:"list-header"},He={class:"header-left"},Je={class:"m3-badge secondary"},Xe={class:"view-toggle"},st={class:"platform-filter"},et={class:"platform-chips"},tt={class:"chip-count"},ot=["onClick"],lt={class:"chip-count"},at={key:0,class:"graph-view-container"},nt={key:1,class:"loading-state"},it={key:2,class:"person-grid"},rt=["onClick"],dt={class:"card-header-mini"},ut={class:"person-info"},ct={class:"person-name"},pt={key:0,class:"person-nickname"},mt={class:"card-body-mini"},vt={class:"relation-score-mini"},ft={class:"score-bar-mini-container"},ht={class:"score-bar-mini"},bt={class:"score-text-mini"},yt={key:0,class:"relation-text-mini"},_t={class:"text-truncate"},gt={key:1,class:"impression-mini"},wt={class:"text-truncate"},kt={class:"card-footer-mini"},xt={class:"stat-item"},Ct={key:0,class:"stat-item"},Vt={key:3,class:"empty-state"},$t={key:4,class:"pagination"},Pt=["disabled"],Rt={class:"page-numbers"},St=["onClick"],Et=["disabled"],It={class:"dialog-header"},Dt={class:"dialog-content"},zt={class:"form-section"},Mt={class:"form-group"},Ft={class:"score-input-container"},Lt={class:"score-value-display"},Nt={class:"score-number"},Ut={class:"score-preview"},Tt={class:"score-hint"},Bt={class:"form-group"},Gt={class:"dialog-actions"},Ot=["disabled"],At={class:"material-symbols-rounded"},jt={class:"dialog-header"},qt={class:"dialog-content"},Kt={class:"form-section"},Wt={class:"form-group"},Qt={class:"char-count"},Yt={class:"form-group"},Zt={class:"dialog-actions"},Ht=["disabled"],Jt={class:"material-symbols-rounded"},Xt={class:"dialog-header"},so={class:"dialog-content scrollable"},eo={class:"form-section"},to={class:"section-header"},oo={class:"section-title"},lo={class:"m3-badge"},ao={key:0,class:"empty-hint modern"},no={class:"point-edit-header"},io={class:"point-index"},ro={class:"point-weight-control"},uo={class:"weight-slider-wrapper"},co=["onUpdate:modelValue"],po={class:"weight-value"},mo=["onClick"],vo={class:"point-edit-body"},fo=["onUpdate:modelValue"],ho={class:"point-timestamp"},bo={class:"dialog-actions"},yo=["disabled"],_o={class:"material-symbols-rounded"},go=as({__name:"RelationshipView",setup(r){const n=v(""),p=v(!1),h=v(""),c=v(null),m=v(""),k=v([]),f=v(1),g=v(20),y=v(0),D=v(0),z=v(!1),R=v([]),C=v(""),B=v(!1),S=v("list"),V=v(!1),E=v(!1),I=v(!1),_=v(!1),l=$s({score:0,text:"",impression:"",shortImpression:"",memoryPoints:[]}),u=async()=>{z.value=!0,h.value="";try{const t=await X(f.value,g.value,C.value||void 0);t.success&&t.data?(k.value=t.data.persons,y.value=t.data.total_pages,D.value=t.data.total):h.value=t.error||"åŠ è½½ç”¨æˆ·åˆ—è¡¨å¤±è´¥"}catch(t){h.value=t instanceof Error?t.message:"åŠ è½½å¤±è´¥"}finally{z.value=!1}},b=async()=>{B.value=!0;try{const t=await J();t.success&&t.data&&(R.value=t.data.platforms)}catch(t){console.error("åŠ è½½å¹³å°åˆ—è¡¨å¤±è´¥:",t)}finally{B.value=!1}},$=async()=>{f.value=1,await u()};ns(()=>{u(),b()});const ps=Ps(()=>{const t=[];let o=Math.max(1,f.value-Math.floor(2.5)),w=Math.min(y.value,o+5-1);w-o<4&&(o=Math.max(1,w-5+1));for(let M=o;M<=w;M++)t.push(M);return t}),ms=()=>{n.value=""},W=async t=>{t<1||t>y.value||(f.value=t,await u(),window.scrollTo({top:0,behavior:"smooth"}))},ss=async t=>{m.value=t,await G()},vs=()=>{c.value=null,m.value="",n.value="",u()},es=async()=>{if(!n.value.trim()){await K("è¯·è¾“å…¥ç”¨æˆ·å");return}p.value=!0,h.value="",c.value=null;try{const t=await us(n.value.trim());t.success&&t.data?(m.value=t.data.person_id,await G()):h.value=t.error||"æœªæ‰¾åˆ°ç”¨æˆ·"}catch(t){h.value=t instanceof Error?t.message:"æœç´¢å¤±è´¥"}finally{p.value=!1}},G=async()=>{var t;if(m.value){console.log("[RelationshipView] å¼€å§‹åŠ è½½ç”¨æˆ·è¯¦æƒ…, personId:",m.value),p.value=!0,h.value="";try{const e=await rs(m.value);console.log("[RelationshipView] è·å–ç”¨æˆ·è¯¦æƒ…ç»“æœ:",e),e.success&&e.data?(console.log("[RelationshipView] æ›´æ–° personDetail.value:",e.data),console.log("[RelationshipView] è¯¦ç»†å°è±¡å€¼:",e.data.impression),console.log("[RelationshipView] ç®€çŸ­å°è±¡å€¼:",e.data.short_impression),console.log("[RelationshipView] è®°å¿†ç‚¹æ•°é‡:",(t=e.data.memory_points)==null?void 0:t.length),c.value={basic_info:{...e.data.basic_info},relationship:{...e.data.relationship},impression:e.data.impression,short_impression:e.data.short_impression,memory_points:[...e.data.memory_points||[]]},l.score=e.data.relationship.relationship_score*100,l.text=e.data.relationship.relationship_text||"",console.log("[RelationshipView] personDetail å·²æ›´æ–°, æ–°å€¼:",c.value)):(console.error("[RelationshipView] åŠ è½½ç”¨æˆ·è¯¦æƒ…å¤±è´¥:",e.error),h.value=e.error||"åŠ è½½ç”¨æˆ·è¯¦æƒ…å¤±è´¥")}catch(e){console.error("[RelationshipView] åŠ è½½ç”¨æˆ·è¯¦æƒ…å¼‚å¸¸:",e),h.value=e instanceof Error?e.message:"åŠ è½½å¤±è´¥"}finally{p.value=!1}}},fs=()=>{c.value&&(l.score=c.value.relationship.relationship_score*100,l.text=c.value.relationship.relationship_text||"",V.value=!0)},hs=()=>{c.value&&(l.impression=c.value.impression||"",l.shortImpression=c.value.short_impression||"",E.value=!0)},bs=()=>{c.value&&(l.memoryPoints=c.value.memory_points.map(t=>({content:t.content,weight:t.weight,timestamp:t.timestamp})),I.value=!0)},ys=()=>{l.memoryPoints.push({content:"",weight:.5,timestamp:new Date().toISOString()})},_s=t=>{l.memoryPoints.splice(t,1)},gs=async()=>{if(m.value){console.log("[RelationshipView] å¼€å§‹ä¿å­˜å…³ç³»ä¿¡æ¯, personId:",m.value),console.log("[RelationshipView] æäº¤æ•°æ®:",{relationship_score:l.score/100,relationship_text:l.text}),_.value=!0;try{const t=await ds(m.value,{relationship_score:l.score/100,relationship_text:l.text});if(console.log("[RelationshipView] ä¿å­˜å…³ç³»ä¿¡æ¯å“åº”:",t),!t.success)throw new Error(t.error||"æ›´æ–°å…³ç³»ä¿¡æ¯å¤±è´¥");if(t.data&&!t.data.success)throw new Error(t.data.message||"æ›´æ–°å…³ç³»ä¿¡æ¯å¤±è´¥");console.log("[RelationshipView] å…³ç³»ä¿¡æ¯ä¿å­˜æˆåŠŸï¼Œå‡†å¤‡é‡æ–°åŠ è½½è¯¦æƒ…"),await H("å…³ç³»ä¿¡æ¯å·²æ›´æ–°"),V.value=!1,console.log("[RelationshipView] å¼€å§‹é‡æ–°åŠ è½½ç”¨æˆ·è¯¦æƒ…"),await G(),console.log("[RelationshipView] ç”¨æˆ·è¯¦æƒ…é‡æ–°åŠ è½½å®Œæˆ")}catch(t){console.error("[RelationshipView] ä¿å­˜å…³ç³»ä¿¡æ¯å¤±è´¥:",t),await K(t instanceof Error?t.message:"æ›´æ–°å¤±è´¥")}finally{_.value=!1}}},ws=async()=>{if(m.value){console.log("[RelationshipView] å¼€å§‹ä¿å­˜å°è±¡, personId:",m.value),console.log("[RelationshipView] æäº¤æ•°æ®:",{impression:l.impression,short_impression:l.shortImpression}),_.value=!0;try{const{updatePersonImpression:t}=await os(async()=>{const{updatePersonImpression:o}=await Promise.resolve().then(()=>ls);return{updatePersonImpression:o}},void 0),e=await t(m.value,l.impression,l.shortImpression);if(console.log("[RelationshipView] ä¿å­˜å°è±¡å“åº”:",e),!e.success)throw new Error(e.error||"æ›´æ–°å°è±¡å¤±è´¥");if(e.data&&!e.data.success)throw new Error(e.data.message||"æ›´æ–°å°è±¡å¤±è´¥");console.log("[RelationshipView] å°è±¡ä¿å­˜æˆåŠŸï¼Œå‡†å¤‡é‡æ–°åŠ è½½è¯¦æƒ…"),await H("å°è±¡å·²æ›´æ–°"),E.value=!1,console.log("[RelationshipView] å¼€å§‹é‡æ–°åŠ è½½ç”¨æˆ·è¯¦æƒ…"),await G(),console.log("[RelationshipView] ç”¨æˆ·è¯¦æƒ…é‡æ–°åŠ è½½å®Œæˆ")}catch(t){console.error("[RelationshipView] ä¿å­˜å°è±¡å¤±è´¥:",t),await K(t instanceof Error?t.message:"æ›´æ–°å¤±è´¥")}finally{_.value=!1}}},ks=async()=>{if(m.value){console.log("[RelationshipView] å¼€å§‹ä¿å­˜è®°å¿†ç‚¹, personId:",m.value),console.log("[RelationshipView] æäº¤æ•°æ®:",l.memoryPoints),_.value=!0;try{const{updatePersonPoints:t}=await os(async()=>{const{updatePersonPoints:o}=await Promise.resolve().then(()=>ls);return{updatePersonPoints:o}},void 0),e=await t(m.value,l.memoryPoints);if(console.log("[RelationshipView] ä¿å­˜è®°å¿†ç‚¹å“åº”:",e),!e.success)throw new Error(e.error||"æ›´æ–°è®°å¿†ç‚¹å¤±è´¥");if(e.data&&!e.data.success)throw new Error(e.data.message||"æ›´æ–°è®°å¿†ç‚¹å¤±è´¥");console.log("[RelationshipView] è®°å¿†ç‚¹ä¿å­˜æˆåŠŸï¼Œå‡†å¤‡é‡æ–°åŠ è½½è¯¦æƒ…"),await H("è®°å¿†ç‚¹å·²æ›´æ–°"),I.value=!1,console.log("[RelationshipView] å¼€å§‹é‡æ–°åŠ è½½ç”¨æˆ·è¯¦æƒ…"),await G(),console.log("[RelationshipView] ç”¨æˆ·è¯¦æƒ…é‡æ–°åŠ è½½å®Œæˆ")}catch(t){console.error("[RelationshipView] ä¿å­˜è®°å¿†ç‚¹å¤±è´¥:",t),await K(t instanceof Error?t.message:"æ›´æ–°å¤±è´¥")}finally{_.value=!1}}},q=t=>{if(!t)return"æœªçŸ¥";try{let e;return typeof t=="string"&&!isNaN(Number(t))?e=new Date(Number(t)*1e3):typeof t=="number"?e=new Date(t*1e3):e=new Date(t),isNaN(e.getTime())?"æœªçŸ¥":e.toLocaleString("zh-CN")}catch{return"æœªçŸ¥"}},xs=t=>t>=90?"ğŸŒŸ äº²å¯†æ— é—´":t>=80?"ğŸ’– éå¸¸äº²å¯†":t>=70?"ğŸ˜Š å…³ç³»è‰¯å¥½":t>=60?"ğŸ‘ æ¯”è¾ƒç†Ÿæ‚‰":t>=50?"ğŸ™‚ ä¸€èˆ¬ç†Ÿæ‚‰":t>=40?"ğŸ˜ ç•¥æœ‰äº†è§£":t>=30?"ğŸ¤” åˆæ­¥è®¤è¯†":t>=20?"ğŸ‘‹ åˆšåˆšè§é¢":"â“ é™Œç”Ÿäºº",Q=v(!1);return(t,e)=>(i(),d("div",ie,[c.value?(i(),d("div",re,[s("button",{class:"m3-button tonal",onClick:vs},[...e[24]||(e[24]=[s("span",{class:"material-symbols-rounded"},"arrow_back",-1),s("span",null,"è¿”å›åˆ—è¡¨",-1)])])])):(i(),d("div",de,[s("div",{class:F(["search-wrapper",{focused:Q.value}])},[e[26]||(e[26]=s("span",{class:"material-symbols-rounded search-icon"},"search",-1)),P(s("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>n.value=o),type:"text",class:"search-input",placeholder:"æœç´¢ç”¨æˆ·å...",onFocus:e[1]||(e[1]=o=>Q.value=!0),onBlur:e[2]||(e[2]=o=>Q.value=!1),onKeyup:Rs(es,["enter"])},null,544),[[L,n.value]]),n.value?(i(),d("button",{key:0,class:"icon-button clear-btn",onClick:ms},[...e[25]||(e[25]=[s("span",{class:"material-symbols-rounded"},"cancel",-1)])])):x("",!0)],2),s("button",{class:"m3-button filled",onClick:es},[...e[27]||(e[27]=[s("span",{class:"material-symbols-rounded"},"search",-1),s("span",null,"æœç´¢",-1)])])])),p.value?(i(),d("div",ue,[...e[28]||(e[28]=[s("span",{class:"material-symbols-rounded spinning loading-icon"},"progress_activity",-1),s("p",null,"åŠ è½½ä¸­...",-1)])])):h.value?(i(),d("div",ce,[e[30]||(e[30]=s("span",{class:"material-symbols-rounded error-icon"},"error",-1)),e[31]||(e[31]=s("h3",null,"åŠ è½½å¤±è´¥",-1)),s("p",null,a(h.value),1),s("button",{class:"m3-button filled",onClick:G},[...e[29]||(e[29]=[s("span",{class:"material-symbols-rounded"},"refresh",-1),s("span",null,"é‡è¯•",-1)])])])):c.value?(i(),d("div",pe,[s("div",me,[e[38]||(e[38]=s("div",{class:"card-header"},[s("div",{class:"header-title"},[s("span",{class:"material-symbols-rounded header-icon"},"person"),s("h2",null,"åŸºç¡€ä¿¡æ¯")])],-1)),s("div",ve,[s("div",fe,[s("div",he,[e[32]||(e[32]=s("label",null,"ç”¨æˆ·å",-1)),s("span",be,a(c.value.basic_info.person_name),1)]),s("div",ye,[e[33]||(e[33]=s("label",null,"æ˜µç§°",-1)),s("span",_e,a(c.value.basic_info.nickname||"æœªè®¾ç½®"),1)]),s("div",ge,[e[34]||(e[34]=s("label",null,"è®¤è¯†æ¬¡æ•°",-1)),s("span",we,a(c.value.basic_info.know_times),1)]),s("div",ke,[e[35]||(e[35]=s("label",null,"æ€åº¦",-1)),s("span",xe,a(c.value.basic_info.attitude||"æœªçŸ¥"),1)]),s("div",Ce,[e[36]||(e[36]=s("label",null,"è®¤è¯†æ—¶é—´",-1)),s("span",Ve,a(q(c.value.basic_info.know_since)),1)]),s("div",$e,[e[37]||(e[37]=s("label",null,"æœ€åè§é¢",-1)),s("span",Pe,a(q(c.value.basic_info.last_know)),1)])])])]),s("div",Re,[s("div",{class:"card-header"},[e[40]||(e[40]=s("div",{class:"header-title"},[s("span",{class:"material-symbols-rounded header-icon"},"favorite"),s("h2",null,"å…³ç³»ä¿¡æ¯")],-1)),s("button",{class:"m3-button text",onClick:fs},[...e[39]||(e[39]=[s("span",{class:"material-symbols-rounded"},"edit",-1),s("span",null,"ç¼–è¾‘",-1)])])]),s("div",Se,[s("div",Ee,[e[41]||(e[41]=s("label",null,"å…³ç³»åˆ†æ•°",-1)),s("div",Ie,[s("div",De,[s("div",{class:"score-fill",style:Y({width:`${c.value.relationship.relationship_score*100}%`})},null,4)]),s("span",ze,a((c.value.relationship.relationship_score*100).toFixed(1))+"%",1)])]),s("div",Me,[e[42]||(e[42]=s("label",null,"å…³ç³»æè¿°",-1)),s("p",null,a(c.value.relationship.relationship_text||"æš‚æ— æè¿°"),1)])])]),s("div",Fe,[s("div",{class:"card-header"},[e[44]||(e[44]=s("div",{class:"header-title"},[s("span",{class:"material-symbols-rounded header-icon"},"psychology"),s("h2",null,"æˆ‘çš„å°è±¡")],-1)),s("button",{class:"m3-button text",onClick:hs},[...e[43]||(e[43]=[s("span",{class:"material-symbols-rounded"},"edit",-1),s("span",null,"ç¼–è¾‘",-1)])])]),s("div",Le,[s("div",Ne,[e[45]||(e[45]=s("h3",null,"è¯¦ç»†å°è±¡",-1)),s("p",Ue,a(c.value.impression||"æš‚æ— å°è±¡"),1)]),s("div",Te,[e[46]||(e[46]=s("h3",null,"ç®€çŸ­å°è±¡",-1)),s("p",Be,a(c.value.short_impression||"æš‚æ— å°è±¡"),1)])])]),s("div",Ge,[s("div",{class:"card-header"},[e[48]||(e[48]=s("div",{class:"header-title"},[s("span",{class:"material-symbols-rounded header-icon"},"bookmark"),s("h2",null,"é‡è¦è®°å¿†ç‚¹")],-1)),s("button",{class:"m3-button text",onClick:bs},[...e[47]||(e[47]=[s("span",{class:"material-symbols-rounded"},"edit",-1),s("span",null,"ç¼–è¾‘",-1)])])]),s("div",Oe,[c.value.memory_points.length===0?(i(),d("div",Ae,[...e[49]||(e[49]=[s("p",null,"æš‚æ— è®°å¿†ç‚¹",-1)])])):(i(),d("div",je,[(i(!0),d(A,null,j(c.value.memory_points,(o,w)=>(i(),d("div",{key:w,class:"memory-point"},[s("div",qe,[s("span",Ke,"é‡è¦æ€§: "+a(o.weight.toFixed(2)),1),s("span",We,a(q(o.timestamp)),1)]),s("p",Qe,a(o.content),1)]))),128))]))])])])):(i(),d("div",Ye,[s("div",Ze,[s("div",He,[e[50]||(e[50]=s("h2",null,"ç”¨æˆ·å…³ç³»",-1)),s("span",Je,"å…± "+a(D.value)+" äºº",1)]),s("div",Xe,[s("button",{class:F(["toggle-btn",{active:S.value==="list"}]),onClick:e[3]||(e[3]=o=>S.value="list"),title:"åˆ—è¡¨è§†å›¾"},[...e[51]||(e[51]=[s("span",{class:"material-symbols-rounded"},"view_list",-1)])],2),s("button",{class:F(["toggle-btn",{active:S.value==="graph"}]),onClick:e[4]||(e[4]=o=>S.value="graph"),title:"å›¾è°±è§†å›¾"},[...e[52]||(e[52]=[s("span",{class:"material-symbols-rounded"},"account_tree",-1)])],2)])]),s("div",st,[e[54]||(e[54]=s("div",{class:"filter-label"},[s("span",{class:"material-symbols-rounded"},"filter_list"),s("span",null,"æŒ‰å¹³å°ç­›é€‰")],-1)),s("div",et,[s("button",{class:F(["platform-chip",{active:C.value===""}]),onClick:e[5]||(e[5]=o=>{C.value="",$()})},[e[53]||(e[53]=s("span",null,"å…¨éƒ¨",-1)),s("span",tt,a(R.value.reduce((o,w)=>o+w.count,0)),1)],2),(i(!0),d(A,null,j(R.value,o=>(i(),d("button",{key:o.platform,class:F(["platform-chip",{active:C.value===o.platform}]),onClick:w=>{C.value=o.platform,$()}},[s("span",null,a(o.platform),1),s("span",lt,a(o.count),1)],10,ot))),128))])]),S.value==="graph"?(i(),d("div",at,[N(ne,{onNodeClick:ss})])):z.value?(i(),d("div",nt,[...e[55]||(e[55]=[s("span",{class:"material-symbols-rounded spinning loading-icon"},"progress_activity",-1),s("p",null,"åŠ è½½ä¸­...",-1)])])):S.value==="list"&&k.value.length>0?(i(),d("div",it,[(i(!0),d(A,null,j(k.value,o=>(i(),d("div",{key:o.person_id,class:"m3-card person-card clickable",onClick:w=>ss(o.person_id)},[s("div",dt,[e[56]||(e[56]=s("div",{class:"person-avatar"},[s("span",{class:"material-symbols-rounded"},"person")],-1)),s("div",ut,[s("h3",ct,a(o.person_name),1),o.nickname?(i(),d("p",pt,a(o.nickname),1)):x("",!0)])]),s("div",mt,[s("div",vt,[e[57]||(e[57]=s("label",null,"å…³ç³»åˆ†æ•°",-1)),s("div",ft,[s("div",ht,[s("div",{class:"score-fill-mini",style:Y({width:`${o.relationship_score*100}%`})},null,4)]),s("span",bt,a((o.relationship_score*100).toFixed(0))+"%",1)])]),o.relationship_text?(i(),d("div",yt,[e[58]||(e[58]=s("span",{class:"material-symbols-rounded mini-icon"},"chat_bubble_outline",-1)),s("span",_t,a(o.relationship_text),1)])):x("",!0),o.short_impression?(i(),d("div",gt,[e[59]||(e[59]=s("span",{class:"material-symbols-rounded mini-icon"},"auto_awesome",-1)),s("span",wt,a(o.short_impression),1)])):x("",!0),s("div",kt,[s("div",xt,[e[60]||(e[60]=s("span",{class:"material-symbols-rounded stat-icon"},"forum",-1)),s("span",null,"äº¤äº’ "+a(o.know_times)+" æ¬¡",1)]),o.last_know?(i(),d("div",Ct,[e[61]||(e[61]=s("span",{class:"material-symbols-rounded stat-icon"},"schedule",-1)),s("span",null,a(q(o.last_know)),1)])):x("",!0)])])],8,rt))),128))])):(i(),d("div",Vt,[...e[62]||(e[62]=[s("span",{class:"material-symbols-rounded empty-icon"},"group_off",-1),s("h3",null,"æš‚æ— ç”¨æˆ·",-1),s("p",null,"è¿˜æ²¡æœ‰è®¤è¯†çš„ç”¨æˆ·",-1)])])),y.value>1?(i(),d("div",$t,[s("button",{class:"m3-button tonal",disabled:f.value===1,onClick:e[6]||(e[6]=o=>W(f.value-1))},[...e[63]||(e[63]=[s("span",{class:"material-symbols-rounded"},"chevron_left",-1),s("span",null,"ä¸Šä¸€é¡µ",-1)])],8,Pt),s("div",Rt,[(i(!0),d(A,null,j(ps.value,o=>(i(),d("button",{key:o,class:F(["page-number-btn",{active:o===f.value}]),onClick:w=>W(o)},a(o),11,St))),128))]),s("button",{class:"m3-button tonal",disabled:f.value===y.value,onClick:e[7]||(e[7]=o=>W(f.value+1))},[...e[64]||(e[64]=[s("span",null,"ä¸‹ä¸€é¡µ",-1),s("span",{class:"material-symbols-rounded"},"chevron_right",-1)])],8,Et)])):x("",!0)])),N(O,{name:"dialog-fade"},{default:U(()=>[V.value?(i(),d("div",{key:0,class:"m3-dialog-overlay",onClick:e[13]||(e[13]=o=>V.value=!1)},[N(O,{name:"dialog-scale"},{default:U(()=>[V.value?(i(),d("div",{key:0,class:"m3-dialog modern",onClick:e[12]||(e[12]=Z(()=>{},["stop"]))},[s("div",It,[e[66]||(e[66]=s("div",{class:"header-icon-wrapper"},[s("span",{class:"material-symbols-rounded header-icon"},"favorite")],-1)),e[67]||(e[67]=s("div",{class:"header-content"},[s("h3",null,"ç¼–è¾‘å…³ç³»ä¿¡æ¯"),s("p",{class:"header-subtitle"},"è°ƒæ•´ä¸ç”¨æˆ·çš„å…³ç³»æè¿°")],-1)),s("button",{class:"m3-icon-button",onClick:e[8]||(e[8]=o=>V.value=!1)},[...e[65]||(e[65]=[s("span",{class:"material-symbols-rounded"},"close",-1)])])]),s("div",Dt,[s("div",zt,[s("div",Mt,[e[69]||(e[69]=s("label",{class:"m3-label"},[s("span",{class:"material-symbols-rounded label-icon"},"favorite"),s("span",null,"å…³ç³»åˆ†æ•°")],-1)),s("div",Ft,[P(s("input",{"onUpdate:modelValue":e[9]||(e[9]=o=>l.score=o),type:"range",min:"0",max:"100",class:"m3-slider"},null,512),[[L,l.score,void 0,{number:!0}]]),s("div",Lt,[s("span",Nt,a(l.score),1),e[68]||(e[68]=s("span",{class:"score-unit"},"åˆ†",-1))])]),s("div",Ut,[s("div",{class:"score-fill",style:Y({width:l.score+"%"})},null,4)]),s("div",Tt,[s("span",null,a(xs(l.score)),1)])]),s("div",Bt,[e[70]||(e[70]=s("label",{class:"m3-label"},[s("span",{class:"material-symbols-rounded label-icon"},"description"),s("span",null,"å…³ç³»æè¿°")],-1)),P(s("textarea",{"onUpdate:modelValue":e[10]||(e[10]=o=>l.text=o),class:"m3-textarea",rows:"4",placeholder:"æè¿°ä½ ä¸è¿™ä¸ªç”¨æˆ·çš„å…³ç³»..."},null,512),[[L,l.text]]),s("div",{class:F(["char-count",{warning:l.text.length>200}])},a(l.text.length)+" / 200 ",3)])])]),s("div",Gt,[s("button",{class:"m3-button text",onClick:e[11]||(e[11]=o=>V.value=!1)},[...e[71]||(e[71]=[s("span",{class:"material-symbols-rounded"},"close",-1),s("span",null,"å–æ¶ˆ",-1)])]),s("button",{class:"m3-button filled",onClick:gs,disabled:_.value},[s("span",At,a(_.value?"progress_activity":"check"),1),s("span",null,a(_.value?"ä¿å­˜ä¸­...":"ä¿å­˜"),1)],8,Ot)])])):x("",!0)]),_:1})])):x("",!0)]),_:1}),N(O,{name:"dialog-fade"},{default:U(()=>[E.value?(i(),d("div",{key:0,class:"m3-dialog-overlay",onClick:e[19]||(e[19]=o=>E.value=!1)},[N(O,{name:"dialog-scale"},{default:U(()=>[E.value?(i(),d("div",{key:0,class:"m3-dialog modern large",onClick:e[18]||(e[18]=Z(()=>{},["stop"]))},[s("div",jt,[e[73]||(e[73]=s("div",{class:"header-icon-wrapper"},[s("span",{class:"material-symbols-rounded header-icon"},"psychology")],-1)),e[74]||(e[74]=s("div",{class:"header-content"},[s("h3",null,"ç¼–è¾‘å°è±¡"),s("p",{class:"header-subtitle"},"è®°å½•ä½ å¯¹ç”¨æˆ·çš„å°è±¡å’Œæ„Ÿå—")],-1)),s("button",{class:"m3-icon-button",onClick:e[14]||(e[14]=o=>E.value=!1)},[...e[72]||(e[72]=[s("span",{class:"material-symbols-rounded"},"close",-1)])])]),s("div",qt,[s("div",Kt,[s("div",Wt,[e[75]||(e[75]=s("label",{class:"m3-label"},[s("span",{class:"material-symbols-rounded label-icon"},"article"),s("span",null,"è¯¦ç»†å°è±¡")],-1)),P(s("textarea",{"onUpdate:modelValue":e[15]||(e[15]=o=>l.impression=o),class:"m3-textarea",rows:"6",placeholder:"è¯¦ç»†æè¿°ä½ å¯¹è¿™ä¸ªç”¨æˆ·çš„å°è±¡..."},null,512),[[L,l.impression]]),s("div",Qt,a(l.impression.length)+" å­—ç¬¦ ",1)]),s("div",Yt,[e[76]||(e[76]=s("label",{class:"m3-label"},[s("span",{class:"material-symbols-rounded label-icon"},"sentiment_satisfied"),s("span",null,"ç®€çŸ­å°è±¡")],-1)),P(s("textarea",{"onUpdate:modelValue":e[16]||(e[16]=o=>l.shortImpression=o),class:"m3-textarea short",rows:"3",placeholder:"ç”¨ç®€çŸ­çš„è¯æ¦‚æ‹¬ä½ çš„å°è±¡..."},null,512),[[L,l.shortImpression]]),s("div",{class:F(["char-count",{warning:l.shortImpression.length>100}])},a(l.shortImpression.length)+" / 100 ",3)])])]),s("div",Zt,[s("button",{class:"m3-button text",onClick:e[17]||(e[17]=o=>E.value=!1)},[...e[77]||(e[77]=[s("span",{class:"material-symbols-rounded"},"close",-1),s("span",null,"å–æ¶ˆ",-1)])]),s("button",{class:"m3-button filled",onClick:ws,disabled:_.value},[s("span",Jt,a(_.value?"progress_activity":"check"),1),s("span",null,a(_.value?"ä¿å­˜ä¸­...":"ä¿å­˜"),1)],8,Ht)])])):x("",!0)]),_:1})])):x("",!0)]),_:1}),N(O,{name:"dialog-fade"},{default:U(()=>[I.value?(i(),d("div",{key:0,class:"m3-dialog-overlay",onClick:e[23]||(e[23]=o=>I.value=!1)},[N(O,{name:"dialog-scale"},{default:U(()=>[I.value?(i(),d("div",{key:0,class:"m3-dialog modern extra-large",onClick:e[22]||(e[22]=Z(()=>{},["stop"]))},[s("div",Xt,[e[79]||(e[79]=s("div",{class:"header-icon-wrapper"},[s("span",{class:"material-symbols-rounded header-icon"},"bookmark")],-1)),e[80]||(e[80]=s("div",{class:"header-content"},[s("h3",null,"ç¼–è¾‘è®°å¿†ç‚¹"),s("p",{class:"header-subtitle"},"ç®¡ç†ä¸ç”¨æˆ·ç›¸å…³çš„é‡è¦è®°å¿†")],-1)),s("button",{class:"m3-icon-button",onClick:e[20]||(e[20]=o=>I.value=!1)},[...e[78]||(e[78]=[s("span",{class:"material-symbols-rounded"},"close",-1)])])]),s("div",so,[s("div",eo,[s("div",to,[s("div",oo,[e[81]||(e[81]=s("span",{class:"material-symbols-rounded"},"collections_bookmark",-1)),e[82]||(e[82]=s("h4",null,"è®°å¿†ç‚¹åˆ—è¡¨",-1)),s("span",lo,a(l.memoryPoints.length),1)]),s("button",{class:"m3-button filled-tonal",onClick:ys,type:"button"},[...e[83]||(e[83]=[s("span",{class:"material-symbols-rounded"},"add",-1),s("span",null,"æ·»åŠ ",-1)])])]),l.memoryPoints.length===0?(i(),d("div",ao,[...e[84]||(e[84]=[s("span",{class:"material-symbols-rounded empty-icon"},"bookmark_border",-1),s("p",null,"æš‚æ— è®°å¿†ç‚¹ï¼Œç‚¹å‡»ã€Œæ·»åŠ ã€æŒ‰é’®åˆ›å»ºæ–°è®°å¿†ç‚¹",-1)])])):(i(),Ss(Es,{key:1,name:"list",tag:"div",class:"memory-points-edit-list"},{default:U(()=>[(i(!0),d(A,null,j(l.memoryPoints,(o,w)=>(i(),d("div",{key:w,class:"memory-point-edit"},[s("div",no,[s("div",io,[e[85]||(e[85]=s("span",{class:"material-symbols-rounded"},"bookmark",-1)),s("span",null,"è®°å¿†ç‚¹ #"+a(w+1),1)]),s("div",ro,[e[86]||(e[86]=s("label",{class:"weight-label"},"é‡è¦åº¦",-1)),s("div",uo,[P(s("input",{"onUpdate:modelValue":M=>o.weight=M,type:"range",min:"0",max:"1",step:"0.1",class:"m3-slider small"},null,8,co),[[L,o.weight,void 0,{number:!0}]]),s("span",po,a((o.weight*100).toFixed(0))+"%",1)])]),s("button",{class:"m3-icon-button error",onClick:M=>_s(w),type:"button",title:"åˆ é™¤"},[...e[87]||(e[87]=[s("span",{class:"material-symbols-rounded"},"delete",-1)])],8,mo)]),s("div",vo,[e[89]||(e[89]=s("label",{class:"m3-label"},[s("span",{class:"material-symbols-rounded label-icon"},"edit_note"),s("span",null,"è®°å¿†å†…å®¹")],-1)),P(s("textarea",{"onUpdate:modelValue":M=>o.content=M,class:"m3-textarea",rows:"4",placeholder:"è¾“å…¥è¿™ä¸ªè®°å¿†ç‚¹çš„è¯¦ç»†å†…å®¹..."},null,8,fo),[[L,o.content]]),s("div",ho,[e[88]||(e[88]=s("span",{class:"material-symbols-rounded"},"schedule",-1)),s("span",null,a(q(o.timestamp)),1)])])]))),128))]),_:1}))])]),s("div",bo,[s("button",{class:"m3-button text",onClick:e[21]||(e[21]=o=>I.value=!1)},[...e[90]||(e[90]=[s("span",{class:"material-symbols-rounded"},"close",-1),s("span",null,"å–æ¶ˆ",-1)])]),s("button",{class:"m3-button filled",onClick:ks,disabled:_.value},[s("span",_o,a(_.value?"progress_activity":"check"),1),s("span",null,a(_.value?"ä¿å­˜ä¸­...":"ä¿å­˜"),1)],8,yo)])])):x("",!0)]),_:1})])):x("",!0)]),_:1})]))}}),Po=is(go,[["__scopeId","data-v-7790827f"]]);export{Po as default};
