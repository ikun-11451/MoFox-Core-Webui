import{a as J,c as a,o as l,n as j,e,g as _,t as m,_ as U,r as $,G as D,v as X,p as pe,P as Je,m as K,a0 as te,x as R,f as se,w as Y,F as P,h as W,T as ie,O as Ue,L as Re,N as O,ap as oe,Y as We,a1 as ze,I as ye,A as qe,ab as be,aq as he,y as Ge,i as Ke,a9 as He,a2 as Ye,aa as Xe,q as ve,j as Qe,a3 as Ze,a4 as et,a8 as tt,a5 as st,a6 as lt}from"./index-BiU-y4EU.js";import{V as at}from"./index-BseasBMh.js";const nt={class:"field-left"},ot={class:"field-header"},it={key:0,class:"material-symbols-rounded field-icon"},dt={class:"field-label"},ut={key:1,class:"required-badge"},rt={key:0,class:"field-description"},ct={class:"m3-switch"},mt=["checked","disabled"],vt={class:"switch-track"},ft={class:"switch-thumb"},pt={class:"thumb-icon material-symbols-rounded"},yt=J({__name:"SwitchEditor",props:{field:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:N}){const o=N;function w(d){const r=d.target;o("update:modelValue",r.checked)}return(d,r)=>(l(),a("div",{class:j(["switch-editor",{"is-checked":!!t.modelValue,"is-disabled":t.field.disabled}])},[e("div",nt,[e("div",ot,[t.field.icon?(l(),a("span",it,m(t.field.icon),1)):_("",!0),e("span",dt,m(t.field.label||t.field.key),1),t.field.required?(l(),a("span",ut,"必填")):_("",!0)]),t.field.description||t.field.hint?(l(),a("div",rt,[r[0]||(r[0]=e("span",{class:"material-symbols-rounded desc-icon"},"info",-1)),e("span",null,m(t.field.hint||t.field.description),1)])):_("",!0)]),e("label",ct,[e("input",{type:"checkbox",checked:!!t.modelValue,disabled:t.field.disabled,onChange:w},null,40,mt),e("span",vt,[e("span",ft,[e("span",pt,m(t.modelValue?"check":""),1)])])])],2))}}),bt=U(yt,[["__scopeId","data-v-887b44ff"]]),ht={class:"field-wrapper"},gt=["value","placeholder","disabled","maxlength"],kt={key:0,class:"char-counter"},_t=J({__name:"TextEditor",props:{field:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:N}){const o=t,w=N,d=$(!1),r=D(()=>o.modelValue!==void 0&&o.modelValue!==null&&o.modelValue!=="");function g(x){const n=x.target;w("update:modelValue",n.value)}function V(){w("update:modelValue","")}return(x,n)=>(l(),a("div",{class:j(["m3-text-field-container",{"is-focused":d.value,"has-value":r.value}])},[e("div",ht,[e("input",{type:"text",class:"m3-text-field",value:t.modelValue,placeholder:t.field.placeholder,disabled:t.field.disabled,maxlength:t.field.max_length,onInput:g,onFocus:n[0]||(n[0]=c=>d.value=!0),onBlur:n[1]||(n[1]=c=>d.value=!1)},null,40,gt),n[3]||(n[3]=e("div",{class:"field-decoration"},[e("div",{class:"field-border"}),e("div",{class:"field-focus-indicator"})],-1)),r.value&&!t.field.disabled?(l(),a("button",{key:0,type:"button",class:"clear-button",onClick:V,tabindex:"-1"},[...n[2]||(n[2]=[e("span",{class:"material-symbols-rounded"},"close",-1)])])):_("",!0)]),t.field.max_length?(l(),a("div",kt,m(String(t.modelValue||"").length)+" / "+m(t.field.max_length),1)):_("",!0)],2))}}),fe=U(_t,[["__scopeId","data-v-249fda96"]]),$t={class:"field-wrapper"},wt=["type","value","placeholder","disabled","maxlength"],Vt=["aria-label"],xt={class:"material-symbols-rounded"},Ct=J({__name:"PasswordEditor",props:{field:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:N}){const o=t,w=N,d=$(!1),r=$(!1),g=D(()=>o.modelValue!==void 0&&o.modelValue!==null&&o.modelValue!=="");function V(x){const n=x.target;w("update:modelValue",n.value)}return(x,n)=>(l(),a("div",{class:j(["password-editor",{"is-focused":r.value,"has-value":g.value}])},[e("div",$t,[n[3]||(n[3]=e("span",{class:"leading-icon material-symbols-rounded"},"key",-1)),e("input",{type:d.value?"text":"password",class:"password-input",value:t.modelValue,placeholder:t.field.placeholder||"输入密码",disabled:t.field.disabled,maxlength:t.field.max_length,onInput:V,onFocus:n[0]||(n[0]=c=>r.value=!0),onBlur:n[1]||(n[1]=c=>r.value=!1)},null,40,wt),e("button",{type:"button",class:"password-toggle",onClick:n[2]||(n[2]=c=>d.value=!d.value),"aria-label":d.value?"隐藏密码":"显示密码",tabindex:"-1"},[e("span",xt,m(d.value?"visibility_off":"visibility"),1)],8,Vt),n[4]||(n[4]=e("div",{class:"field-decoration"},[e("div",{class:"field-border"}),e("div",{class:"field-focus-indicator"})],-1))])],2))}}),St=U(Ct,[["__scopeId","data-v-7cfb0873"]]),It=["disabled"],Ft={class:"number-input-wrapper"},Et=["value","placeholder","disabled","min","max","step"],Nt={key:0,class:"range-indicator"},Dt={key:0},jt={key:1},Lt={key:2},Bt=["disabled"],Ot=J({__name:"NumberEditor",props:{field:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:N}){const o=t,w=N,d=$(!1),r=D(()=>{const b=Number(o.modelValue);return isNaN(b)?0:b}),g=D(()=>o.field.min!==void 0&&r.value<=o.field.min),V=D(()=>o.field.max!==void 0&&r.value>=o.field.max);function x(b){const y=b.target,F=o.field.type==="int"?parseInt(y.value,10):parseFloat(y.value);w("update:modelValue",isNaN(F)?0:F)}function n(){const b=o.field.step||1;let y=r.value-b;o.field.min!==void 0&&y<o.field.min&&(y=o.field.min),w("update:modelValue",o.field.type==="int"?Math.floor(y):y)}function c(){const b=o.field.step||1;let y=r.value+b;o.field.max!==void 0&&y>o.field.max&&(y=o.field.max),w("update:modelValue",o.field.type==="int"?Math.floor(y):y)}return(b,y)=>(l(),a("div",{class:j(["number-editor",{"is-focused":d.value}])},[e("button",{type:"button",class:"stepper-button decrease",disabled:t.field.disabled||g.value,onClick:n},[...y[2]||(y[2]=[e("span",{class:"material-symbols-rounded"},"remove",-1)])],8,It),e("div",Ft,[e("input",{type:"number",class:"number-input",value:t.modelValue,placeholder:t.field.placeholder,disabled:t.field.disabled,min:t.field.min,max:t.field.max,step:t.field.step||1,onInput:x,onFocus:y[0]||(y[0]=F=>d.value=!0),onBlur:y[1]||(y[1]=F=>d.value=!1)},null,40,Et),t.field.min!==void 0||t.field.max!==void 0?(l(),a("div",Nt,[t.field.min!==void 0?(l(),a("span",Dt,m(t.field.min),1)):_("",!0),t.field.min!==void 0&&t.field.max!==void 0?(l(),a("span",jt," ~ ")):_("",!0),t.field.max!==void 0?(l(),a("span",Lt,m(t.field.max),1)):_("",!0)])):_("",!0)]),e("button",{type:"button",class:"stepper-button increase",disabled:t.field.disabled||V.value,onClick:c},[...y[3]||(y[3]=[e("span",{class:"material-symbols-rounded"},"add",-1)])],8,Bt)],2))}}),Mt=U(Ot,[["__scopeId","data-v-eb4bb157"]]),Tt={class:"slider-editor"},Pt={class:"slider-container"},At={class:"slider-track"},Jt=["value","disabled","min","max","step"],Ut={class:"slider-info"},Rt={class:"range-min"},Wt={class:"value-input-wrapper"},zt=["value","min","max","step"],qt={class:"range-max"},Gt=J({__name:"SliderEditor",props:{field:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:N}){const o=t,w=N,d=$(!1),r=D(()=>{const n=Number(o.modelValue);return isNaN(n)?o.field.min??0:n}),g=D(()=>{const n=o.field.min??0,c=o.field.max??100,b=r.value;return Math.min(100,Math.max(0,(b-n)/(c-n)*100))}),V=D(()=>{var c;const n=o.field.step||1;if(n<1){const b=((c=String(n).split(".")[1])==null?void 0:c.length)||0;return r.value.toFixed(b)}return Math.round(r.value)});function x(n){const c=n.target,b=o.field.type==="int"?parseInt(c.value,10):parseFloat(c.value);w("update:modelValue",isNaN(b)?0:b)}return(n,c)=>(l(),a("div",Tt,[e("div",Pt,[e("div",At,[c[3]||(c[3]=e("div",{class:"track-inactive"},null,-1)),e("div",{class:"track-active",style:X({width:g.value+"%"})},null,4)]),e("input",{type:"range",class:"slider-input",value:t.modelValue,disabled:t.field.disabled,min:t.field.min??0,max:t.field.max??100,step:t.field.step||1,onInput:x,onMousedown:c[0]||(c[0]=b=>d.value=!0),onMouseup:c[1]||(c[1]=b=>d.value=!1),onMouseleave:c[2]||(c[2]=b=>d.value=!1)},null,40,Jt),e("div",{class:j(["slider-thumb",{"is-dragging":d.value}]),style:X({left:g.value+"%"})},[...c[4]||(c[4]=[e("div",{class:"thumb-ripple"},null,-1),e("div",{class:"thumb-dot"},null,-1)])],6),e("div",{class:j(["value-tooltip",{"is-visible":d.value}]),style:X({left:g.value+"%"})},m(V.value),7)]),e("div",Ut,[e("span",Rt,m(t.field.min??0),1),e("div",Wt,[e("input",{type:"number",class:"value-input",value:t.modelValue,min:t.field.min??0,max:t.field.max??100,step:t.field.step||1,onInput:x},null,40,zt)]),e("span",qt,m(t.field.max??100),1)])]))}}),Kt=U(Gt,[["__scopeId","data-v-cc4733bd"]]),Ht=["onKeydown"],Yt={class:"select-display"},Xt={key:0,class:"selected-text"},Qt={key:1,class:"placeholder-text"},Zt={class:"dropdown-content"},es=["onClick"],ts={class:"item-label"},ss={key:0,class:"material-symbols-rounded item-check"},ls={key:0,class:"dropdown-empty"},as=J({__name:"SelectEditor",props:{field:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:N}){const o=t,w=N,d=$(!1),r=$(!1),g=$(null),V=$({top:"0px",left:"0px",width:"0px"}),x=D(()=>o.modelValue!==void 0&&o.modelValue!==null&&o.modelValue!==""),n=D(()=>o.field.choices?o.field.choices.map(h=>typeof h=="object"&&h!==null&&"value"in h?h:{value:h,label:String(h)}):[]),c=D(()=>{const h=n.value.find(p=>p.value===o.modelValue);return(h==null?void 0:h.label)||String(o.modelValue)});function b(){if(!g.value)return;const h=g.value.querySelector(".field-wrapper");if(!h)return;const p=h.getBoundingClientRect();V.value={top:`${p.bottom+4}px`,left:`${p.left}px`,width:`${p.width}px`}}function y(){o.field.disabled||(r.value=!r.value,d.value=r.value,r.value?Re(()=>{b(),window.addEventListener("scroll",b,!0),window.addEventListener("resize",b)}):(window.removeEventListener("scroll",b,!0),window.removeEventListener("resize",b)))}function F(){r.value=!1,d.value=!1,window.removeEventListener("scroll",b,!0),window.removeEventListener("resize",b)}function M(h){setTimeout(()=>{F()},200)}function q(h){w("update:modelValue",h),F()}function S(h){const p=h.target,v=document.querySelector(".select-dropdown");g.value&&!g.value.contains(p)&&v&&!v.contains(p)&&F()}return pe(()=>{document.addEventListener("click",S)}),Je(()=>{document.removeEventListener("click",S),window.removeEventListener("scroll",b,!0),window.removeEventListener("resize",b)}),(h,p)=>(l(),a("div",{class:j(["select-editor",{"is-focused":d.value,"has-value":x.value,"is-open":r.value}]),ref_key:"editorRef",ref:g},[e("div",{class:"field-wrapper",onClick:y,tabindex:"0",onFocus:p[0]||(p[0]=v=>d.value=!0),onBlur:M,onKeydown:[te(R(y,["prevent"]),["space"]),te(R(y,["prevent"]),["enter"]),te(F,["esc"])]},[e("div",Yt,[x.value?(l(),a("span",Xt,m(c.value),1)):(l(),a("span",Qt,m(t.field.placeholder||"请选择"),1))]),p[1]||(p[1]=e("span",{class:"select-arrow material-symbols-rounded"},"expand_more",-1)),p[2]||(p[2]=e("div",{class:"field-decoration"},[e("div",{class:"field-border"}),e("div",{class:"field-focus-indicator"})],-1))],40,Ht),(l(),K(Ue,{to:"body"},[se(ie,{name:"dropdown"},{default:Y(()=>[r.value?(l(),a("div",{key:0,class:"select-dropdown",style:X(V.value)},[e("div",Zt,[(l(!0),a(P,null,W(n.value,v=>(l(),a("div",{key:String(v.value),class:j(["dropdown-item",{"is-selected":v.value===t.modelValue}]),onClick:R(I=>q(v.value),["stop"])},[e("span",ts,m(v.label),1),v.value===t.modelValue?(l(),a("span",ss,"check")):_("",!0)],10,es))),128)),n.value.length===0?(l(),a("div",ls," 无选项 ")):_("",!0)])],4)):_("",!0)]),_:1})]))],2))}}),ns=U(as,[["__scopeId","data-v-505e028d"]]),os={class:"field-wrapper"},is=["value","placeholder","disabled","rows","maxlength"],ds={class:"textarea-footer"},us={key:0,class:"line-count"},rs={key:1,class:"char-counter"},cs={key:2,class:"char-counter"},ms=J({__name:"TextareaEditor",props:{field:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:N}){const o=t,w=N,d=$(!1),r=D(()=>String(o.modelValue||"").length),g=D(()=>String(o.modelValue||"").split(`
`).length);function V(x){const n=x.target;w("update:modelValue",n.value)}return(x,n)=>(l(),a("div",{class:j(["textarea-editor",{"is-focused":d.value}])},[e("div",os,[e("textarea",{class:"textarea-input",value:t.modelValue,placeholder:t.field.placeholder||"输入内容...",disabled:t.field.disabled,rows:t.field.rows||4,maxlength:t.field.max_length,onInput:V,onFocus:n[0]||(n[0]=c=>d.value=!0),onBlur:n[1]||(n[1]=c=>d.value=!1)},null,40,is),n[2]||(n[2]=e("div",{class:"field-decoration"},[e("div",{class:"field-border"}),e("div",{class:"field-focus-indicator"})],-1))]),e("div",ds,[g.value>1?(l(),a("span",us,[n[3]||(n[3]=e("span",{class:"material-symbols-rounded"},"format_list_numbered",-1)),O(" "+m(g.value)+" 行 ",1)])):_("",!0),t.field.max_length?(l(),a("span",rs,m(r.value)+" / "+m(t.field.max_length),1)):(l(),a("span",cs,m(r.value)+" 字符 ",1))])],2))}}),vs=U(ms,[["__scopeId","data-v-3f4bd58f"]]),fs={class:"list-editor"},ps={class:"list-header"},ys={class:"header-info"},bs={class:"item-count"},hs={key:0,class:"limit-badge"},gs={key:0},ks={key:1},_s={key:2},$s={class:"list-items"},ws=["onDragstart","onDragover","onDrop"],Vs={class:"item-index"},xs={class:"item-input-wrapper"},Cs=["value","placeholder","onInput"],Ss=["disabled","onClick"],Is=["onDragstart","onDragover","onDrop"],Fs={class:"item-index"},Es={class:"item-input-wrapper"},Ns=["value","placeholder","min","max","step","onInput"],Ds=["disabled","onClick"],js=["onDragstart","onDragover","onDrop"],Ls=["onClick"],Bs={class:"item-index"},Os={class:"object-item-title"},Ms={class:"object-item-actions"},Ts=["onClick"],Ps={class:"material-symbols-rounded"},As=["disabled","onClick"],Js={class:"object-item-content"},Us={key:3,class:"empty-state"},Rs=["disabled"],Ws=J({__name:"ListEditor",props:{field:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:N}){const o=t,w=N,d=D(()=>Array.isArray(o.modelValue)?o.modelValue:[]),r=$([0]),g=$(null);function V(p,v){const I=[...d.value];I[p]=v,w("update:modelValue",I)}function x(p,v,I){const k=[...d.value];k[p]={...k[p],[v]:I},w("update:modelValue",k)}function n(){const p=c(),v=[...d.value,p];w("update:modelValue",v),o.field.item_type==="object"&&r.value.push(v.length-1)}function c(){if(o.field.item_type==="number")return 0;if(o.field.item_type==="object"){const p={};if(o.field.item_fields)for(const v of o.field.item_fields)p[v.key]=v.default;return p}return""}function b(p){const v=[...d.value];v.splice(p,1),w("update:modelValue",v),r.value=r.value.filter(I=>I!==p).map(I=>I>p?I-1:I)}function y(p){const v=r.value.indexOf(p);v>-1?r.value.splice(v,1):r.value.push(p)}function F(p,v){if(o.field.item_fields){const I=o.field.item_fields.find(k=>k.input_type==="text"||k.input_type==="select");if(I&&p[I.key])return String(p[I.key])}return`项目 ${v+1}`}function M(p,v){g.value=p,v.dataTransfer&&(v.dataTransfer.effectAllowed="move",v.dataTransfer.setData("text/plain",String(p)))}function q(p){}function S(p){if(g.value===null||g.value===p)return;const v=[...d.value],[I]=v.splice(g.value,1);v.splice(p,0,I),w("update:modelValue",v),g.value=null}function h(){g.value=null}return(p,v)=>(l(),a("div",fs,[e("div",ps,[e("div",ys,[v[1]||(v[1]=e("span",{class:"material-symbols-rounded header-icon"},"list",-1)),e("span",bs,m(d.value.length),1)]),t.field.min_items||t.field.max_items?(l(),a("div",hs,[t.field.min_items?(l(),a("span",gs,"最小"+m(t.field.min_items),1)):_("",!0),t.field.min_items&&t.field.max_items?(l(),a("span",ks," / ")):_("",!0),t.field.max_items?(l(),a("span",_s,"最大"+m(t.field.max_items),1)):_("",!0)])):_("",!0)]),e("div",$s,[!t.field.item_type||t.field.item_type==="string"?(l(),K(oe,{key:0,name:"list"},{default:Y(()=>[(l(!0),a(P,null,W(d.value,(I,k)=>(l(),a("div",{key:"item-"+k,class:j(["list-item",{"is-dragging":g.value===k}]),draggable:"true",onDragstart:E=>M(k,E),onDragover:R(E=>void 0,["prevent"]),onDrop:E=>S(k),onDragend:h},[v[3]||(v[3]=e("div",{class:"item-handle"},[e("span",{class:"material-symbols-rounded"},"drag_indicator")],-1)),e("div",Vs,m(k+1),1),e("div",xs,[e("input",{type:"text",class:"item-input",value:I,placeholder:t.field.placeholder||`输入第 ${k+1} 项`,onInput:E=>V(k,E.target.value)},null,40,Cs)]),e("button",{type:"button",class:"item-remove-button",disabled:t.field.min_items!==void 0&&d.value.length<=t.field.min_items,onClick:E=>b(k),title:"删除"},[...v[2]||(v[2]=[e("span",{class:"material-symbols-rounded"},"close",-1)])],8,Ss)],42,ws))),128))]),_:1})):t.field.item_type==="number"?(l(),K(oe,{key:1,name:"list"},{default:Y(()=>[(l(!0),a(P,null,W(d.value,(I,k)=>(l(),a("div",{key:"item-"+k,class:j(["list-item",{"is-dragging":g.value===k}]),draggable:"true",onDragstart:E=>M(k,E),onDragover:R(E=>void 0,["prevent"]),onDrop:E=>S(k),onDragend:h},[v[5]||(v[5]=e("div",{class:"item-handle"},[e("span",{class:"material-symbols-rounded"},"drag_indicator")],-1)),e("div",Fs,m(k+1),1),e("div",Es,[e("input",{type:"number",class:"item-input",value:I,placeholder:t.field.placeholder||`输入第 ${k+1} 项`,min:t.field.min,max:t.field.max,step:t.field.step||1,onInput:E=>V(k,parseFloat(E.target.value)||0)},null,40,Ns)]),e("button",{type:"button",class:"item-remove-button",disabled:t.field.min_items!==void 0&&d.value.length<=t.field.min_items,onClick:E=>b(k),title:"删除"},[...v[4]||(v[4]=[e("span",{class:"material-symbols-rounded"},"close",-1)])],8,Ds)],42,Is))),128))]),_:1})):t.field.item_type==="object"&&t.field.item_fields?(l(),K(oe,{key:2,name:"list"},{default:Y(()=>[(l(!0),a(P,null,W(d.value,(I,k)=>(l(),a("div",{key:"item-"+k,class:j(["list-item object-item",{"is-expanded":r.value.includes(k),"is-dragging":g.value===k}]),draggable:"true",onDragstart:E=>M(k,E),onDragover:R(E=>void 0,["prevent"]),onDrop:E=>S(k),onDragend:h},[e("div",{class:"object-item-header",onClick:E=>y(k)},[e("div",{class:"item-handle",onClick:v[0]||(v[0]=R(()=>{},["stop"]))},[...v[6]||(v[6]=[e("span",{class:"material-symbols-rounded"},"drag_indicator",-1)])]),e("div",Bs,m(k+1),1),e("span",Os,m(F(I,k)),1),e("div",Ms,[e("button",{type:"button",class:"expand-button",onClick:R(E=>y(k),["stop"])},[e("span",Ps,m(r.value.includes(k)?"expand_less":"expand_more"),1)],8,Ts),e("button",{type:"button",class:"item-remove-button",disabled:t.field.min_items!==void 0&&d.value.length<=t.field.min_items,onClick:R(E=>b(k),["stop"]),title:"删除"},[...v[7]||(v[7]=[e("span",{class:"material-symbols-rounded"},"close",-1)])],8,As)])],8,Ls),se(ie,{name:"expand"},{default:Y(()=>[We(e("div",Js,[(l(!0),a(P,null,W(t.field.item_fields,E=>(l(),K(ge,{key:E.key,field:E,"model-value":I[E.key],"onUpdate:modelValue":G=>x(k,E.key,G)},null,8,["field","model-value","onUpdate:modelValue"]))),128))],512),[[ze,r.value.includes(k)]])]),_:2},1024)],42,js))),128))]),_:1})):_("",!0),d.value.length===0?(l(),a("div",Us,[...v[8]||(v[8]=[e("span",{class:"material-symbols-rounded empty-icon"},"inbox",-1),e("span",{class:"empty-text"},"暂无项目，点击下方按钮添加",-1)])])):_("",!0)]),e("button",{type:"button",class:"add-button",disabled:t.field.max_items!==void 0&&d.value.length>=t.field.max_items,onClick:n},[...v[9]||(v[9]=[e("span",{class:"material-symbols-rounded"},"add",-1),e("span",null,"添加一项",-1)])],8,Rs)]))}}),zs=U(Ws,[["__scopeId","data-v-6f3bc1d3"]]),qs={class:"editor-header"},Gs={class:"header-actions"},Ks={class:"material-symbols-rounded"},Hs={class:"editor-body"},Ys={class:"line-numbers"},Xs=["value","placeholder","disabled","onKeydown"],Qs={class:"editor-footer"},Zs={key:0,class:"error-message"},el={key:1,class:"status-info"},tl={class:"size-info"},sl=J({__name:"JsonEditor",props:{field:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:N}){const o=t,w=N,d=$(""),r=$(""),g=$(!1),V=$(!1);ye(()=>o.modelValue,S=>{typeof S=="object"&&S!==null?r.value=JSON.stringify(S,null,2):S==null&&(r.value="{}")},{immediate:!0});const x=D(()=>r.value),n=D(()=>Math.max(x.value.split(`
`).length,5));function c(S){const h=S.target;r.value=h.value,d.value="";try{const p=JSON.parse(h.value);w("update:modelValue",p),d.value=""}catch{d.value="无效的JSON 格式"}}function b(){g.value=!1,y()}function y(){try{const S=JSON.parse(r.value);r.value=JSON.stringify(S,null,2),d.value=""}catch{}}function F(){try{const S=JSON.parse(r.value);r.value=JSON.stringify(S),d.value=""}catch{}}function M(){navigator.clipboard.writeText(r.value),V.value=!0,setTimeout(()=>{V.value=!1},2e3)}function q(S){const h=S.target,p=h.selectionStart,v=h.selectionEnd,I=h.value;h.value=I.substring(0,p)+"  "+I.substring(v),h.selectionStart=h.selectionEnd=p+2,r.value=h.value}return(S,h)=>(l(),a("div",{class:j(["json-editor",{"is-focused":g.value,"has-error":!!d.value}])},[e("div",qs,[h[3]||(h[3]=e("div",{class:"header-left"},[e("span",{class:"material-symbols-rounded header-icon"},"data_object"),e("span",{class:"header-label"},"JSON 编辑器")],-1)),e("div",Gs,[e("button",{type:"button",class:"action-button",onClick:y,title:"格式化"},[...h[1]||(h[1]=[e("span",{class:"material-symbols-rounded"},"format_align_left",-1)])]),e("button",{type:"button",class:"action-button",onClick:F,title:"压缩"},[...h[2]||(h[2]=[e("span",{class:"material-symbols-rounded"},"compress",-1)])]),e("button",{type:"button",class:"action-button",onClick:M,title:"复制"},[e("span",Ks,m(V.value?"check":"content_copy"),1)])])]),e("div",Hs,[e("div",Ys,[(l(!0),a(P,null,W(n.value,p=>(l(),a("div",{key:p,class:"line-number"},m(p),1))),128))]),e("textarea",{class:"json-textarea",value:x.value,placeholder:t.field.placeholder||`{
  
}`,disabled:t.field.disabled,spellcheck:"false",onInput:c,onFocus:h[0]||(h[0]=p=>g.value=!0),onBlur:b,onKeydown:te(R(q,["prevent"]),["tab"])},null,40,Xs)]),e("div",Qs,[d.value?(l(),a("div",Zs,[h[4]||(h[4]=e("span",{class:"material-symbols-rounded"},"error",-1)),O(" "+m(d.value),1)])):(l(),a("div",el,[...h[5]||(h[5]=[e("span",{class:"material-symbols-rounded"},"check_circle",-1),O(" JSON 格式正确 ",-1)])])),e("span",tl,m(x.value.length)+" 字符",1)])],2))}}),ll=U(sl,[["__scopeId","data-v-9aa18908"]]),al={class:"color-editor"},nl={class:"color-preview-wrapper"},ol=["value","disabled"],il={class:"color-info"},dl={class:"hex-input-wrapper"},ul=["value","disabled"],rl={class:"color-chips"},cl=["onClick","title"],ml=J({__name:"ColorEditor",props:{field:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:N}){const o=t,w=N,d=$(null),r=D(()=>{const y=String(o.modelValue||"#6750A4");return y.startsWith("#")?y:`#${y}`}),g=D(()=>r.value.replace("#","").toUpperCase()),V=["#6750A4","#D0BCFF","#7F67BE","#4285F4","#34A853","#FBBC05","#EA4335","#FF6D00","#00BCD4"];function x(){var y;(y=d.value)==null||y.click()}function n(y){const F=y.target;w("update:modelValue",F.value.toUpperCase())}function c(y){let M=y.target.value.replace(/[^0-9A-Fa-f]/g,"").toUpperCase();M.length<=6&&w("update:modelValue",`#${M}`)}function b(y){w("update:modelValue",y.toUpperCase())}return(y,F)=>(l(),a("div",al,[e("div",nl,[e("div",{class:"color-preview",style:X({backgroundColor:r.value}),onClick:x},[...F[0]||(F[0]=[e("div",{class:"color-overlay"},null,-1),e("span",{class:"material-symbols-rounded preview-icon"},"colorize",-1)])],4),e("input",{ref_key:"colorInput",ref:d,type:"color",class:"hidden-color-input",value:r.value,disabled:t.field.disabled,onInput:n},null,40,ol)]),e("div",il,[e("div",dl,[F[1]||(F[1]=e("span",{class:"hex-prefix"},"#",-1)),e("input",{type:"text",class:"hex-input",value:g.value,placeholder:"RRGGBB",maxlength:"6",disabled:t.field.disabled,onInput:c},null,40,ul)]),e("div",rl,[(l(),a(P,null,W(V,M=>e("button",{key:M,type:"button",class:j(["color-chip",{"is-selected":r.value.toLowerCase()===M.toLowerCase()}]),style:X({backgroundColor:M}),onClick:q=>b(M),title:M},null,14,cl)),64))])])]))}}),vl=U(ml,[["__scopeId","data-v-e21e963d"]]),fl={class:"field-wrapper"},pl=["value","placeholder","disabled"],yl=["disabled"],bl={key:0,class:"file-info"},hl={class:"material-symbols-rounded file-type-icon"},gl={class:"file-name"},kl=J({__name:"FileEditor",props:{field:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:N}){const o=t,w=N,d=$(!1),r=D(()=>o.modelValue!==void 0&&o.modelValue!==null&&o.modelValue!=="");function g(c){const b=c.target;w("update:modelValue",b.value)}function V(){console.log("Open file picker")}function x(){const c=String(o.modelValue||"");return c.split(/[\\/]/).pop()||c}function n(){const c=String(o.modelValue||"").toLowerCase();return c.endsWith(".json")||c.endsWith(".toml")||c.endsWith(".yaml")?"settings":c.endsWith(".py")?"code":c.endsWith(".txt")||c.endsWith(".md")?"description":c.endsWith(".png")||c.endsWith(".jpg")||c.endsWith(".gif")?"image":/[\\/]$/.test(c)||!c.includes(".")?"folder":"insert_drive_file"}return(c,b)=>(l(),a("div",{class:j(["file-editor",{"is-focused":d.value,"has-value":r.value}])},[e("div",fl,[b[3]||(b[3]=e("span",{class:"leading-icon material-symbols-rounded"},"folder",-1)),e("input",{type:"text",class:"file-input",value:t.modelValue,placeholder:t.field.placeholder||"输入文件路径...",disabled:t.field.disabled,onInput:g,onFocus:b[0]||(b[0]=y=>d.value=!0),onBlur:b[1]||(b[1]=y=>d.value=!1)},null,40,pl),e("button",{type:"button",class:"browse-button",onClick:V,disabled:t.field.disabled,title:"浏览"},[...b[2]||(b[2]=[e("span",{class:"material-symbols-rounded"},"folder_open",-1),e("span",{class:"button-text"},"浏览",-1)])],8,yl),b[4]||(b[4]=e("div",{class:"field-decoration"},[e("div",{class:"field-border"}),e("div",{class:"field-focus-indicator"})],-1))]),r.value?(l(),a("div",bl,[e("span",hl,m(n()),1),e("span",gl,m(x()),1)])):_("",!0)],2))}}),_l=U(kl,[["__scopeId","data-v-309d2bcb"]]),$l={class:"field-header"},wl={key:0,class:"material-symbols-rounded field-icon"},Vl={class:"field-label"},xl={class:"field-type-badge"},Cl={key:1,class:"required-badge"},Sl={key:0,class:"field-description"},Il={class:"field-input-container"},Fl={key:1,class:"field-hint"},El={key:2,class:"field-example"},Nl={key:3,class:"field-error"},Dl=J({__name:"SchemaFieldEditor",props:{field:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:N}){const o=t,w=N,d=$("");function r(n){return{text:fe,password:St,number:Mt,slider:Kt,select:ns,textarea:vs,list:zs,json:ll,color:vl,file:_l}[n]||fe}function g(n){return{text:"文本",password:"密码",number:"数字",slider:"滑块",switch:"开关",select:"选择",textarea:"多行文本",list:"列表",json:"JSON",color:"颜色",file:"路径"}[n]||n}function V(n){w("update:modelValue",n),x(n)}function x(n){if(d.value="",o.field.required&&(n===""||n===null||n===void 0)){d.value="此字段为必填项";return}if(typeof n=="number"){if(o.field.min!==void 0&&n<o.field.min){d.value=`最小值为 ${o.field.min}`;return}if(o.field.max!==void 0&&n>o.field.max){d.value=`最大值为 ${o.field.max}`;return}}if(typeof n=="string"){if(o.field.min_length&&n.length<o.field.min_length){d.value=`最少 ${o.field.min_length} 个字符`;return}if(o.field.max_length&&n.length>o.field.max_length){d.value=`最多 ${o.field.max_length} 个字符`;return}if(o.field.pattern&&!new RegExp(o.field.pattern).test(n)){d.value="格式不正确";return}}}return(n,c)=>(l(),a("div",{class:j(["schema-field-editor",{"is-disabled":t.field.disabled,"is-hidden":t.field.hidden,"is-required":t.field.required,"has-error":d.value,"inline-field":t.field.input_type==="switch"}])},[t.field.input_type==="switch"?(l(),K(bt,{key:0,field:t.field,"model-value":t.modelValue,"onUpdate:modelValue":V},null,8,["field","model-value"])):(l(),a(P,{key:1},[e("div",$l,[t.field.icon?(l(),a("span",wl,m(t.field.icon),1)):_("",!0),e("span",Vl,m(t.field.label||t.field.key),1),e("span",xl,m(g(t.field.input_type)),1),t.field.required?(l(),a("span",Cl,"必填")):_("",!0)]),t.field.description?(l(),a("div",Sl,[c[0]||(c[0]=e("span",{class:"material-symbols-rounded desc-icon"},"info",-1)),e("span",null,m(t.field.description),1)])):_("",!0),e("div",Il,[(l(),K(qe(r(t.field.input_type)),{field:t.field,"model-value":t.modelValue,"onUpdate:modelValue":V},null,8,["field","model-value"]))]),t.field.hint&&!t.field.description?(l(),a("div",Fl,[c[1]||(c[1]=e("span",{class:"material-symbols-rounded"},"lightbulb",-1)),O(" "+m(t.field.hint),1)])):_("",!0),t.field.example?(l(),a("div",El,[c[2]||(c[2]=e("span",{class:"material-symbols-rounded"},"code",-1)),O(" 示例: "+m(t.field.example),1)])):_("",!0),d.value?(l(),a("div",Nl,[c[3]||(c[3]=e("span",{class:"material-symbols-rounded"},"error",-1)),O(" "+m(d.value),1)])):_("",!0)],64))],2))}}),ge=U(Dl,[["__scopeId","data-v-0d784bb4"]]);async function jl(t){return be.get(he.PLUGIN_CONFIG.SCHEMA(t))}async function Ll(t,N,o=!0){return be.post(he.PLUGIN_CONFIG.UPDATE(t),{updates:N,create_backup:o})}const Bl={class:"plugin-config-view"},Ol={class:"config-header"},Ml={class:"header-left"},Tl={class:"header-icon-container"},Pl={class:"material-symbols-rounded header-icon"},Al={class:"header-info"},Jl={class:"config-path"},Ul={key:0,class:"config-description"},Rl={class:"header-actions"},Wl={class:"m3-segmented-button"},zl=["disabled"],ql=["disabled"],Gl=["disabled"],Kl=["disabled"],Hl={key:0,class:"loading-state"},Yl={key:1,class:"error-state"},Xl={key:0,class:"config-nav-bar"},Ql=["onClick"],Zl={class:"material-symbols-rounded"},ea={class:"field-badge"},ta={key:0,class:"schema-badge",title:"Schema 增强"},sa={class:"config-content"},la={key:0,class:"config-section"},aa={class:"section-header"},na={class:"section-title"},oa={key:0,class:"material-symbols-rounded section-icon"},ia={class:"section-badge"},da={key:1,class:"schema-indicator"},ua={key:0,class:"section-description"},ra={class:"fields-list"},ca={class:"field-left"},ma={class:"field-header"},va={class:"field-name"},fa={class:"field-type-badge"},pa={key:0,class:"field-description"},ya={class:"m3-switch"},ba=["checked","onChange"],ha={class:"field-header"},ga={class:"field-name"},ka={class:"field-type-badge"},_a={key:0,class:"field-description"},$a={class:"array-objects-container"},wa={class:"array-objects-info"},Va=["onClick"],xa={class:"field-header"},Ca={class:"field-name"},Sa={class:"field-type-badge"},Ia={key:0,class:"field-description with-margin"},Fa={key:1,class:"field-input-container"},Ea={class:"array-input-wrapper"},Na=["value","onInput"],Da={key:2,class:"field-input-container"},ja=["value","onInput","step"],La={key:3,class:"field-input-container"},Ba=["value","onInput","placeholder"],Oa={key:3,class:"empty-state"},Ma={key:1,class:"source-editor"},Ta={class:"source-toolbar"},Pa={class:"toolbar-left"},Aa={class:"file-path"},Ja={class:"toolbar-actions"},Ua=["disabled"],Ra=["disabled"],Wa={class:"monaco-container"},za={class:"m3-dialog"},qa={class:"dialog-content"},Ga={key:0,class:"loading-state"},Ka={key:1,class:"backup-list"},Ha={class:"backup-info"},Ya={class:"backup-name"},Xa={class:"backup-meta"},Qa={class:"backup-actions"},Za=["onClick"],en={key:2,class:"empty-state"},tn={class:"material-symbols-rounded"},sn=J({__name:"PluginConfigView",setup(t){const N=Ke(),o=Qe(),w=Ge(),d=D(()=>decodeURIComponent(N.params.path)),r=$("visual"),g=$(!1),V=$(!1),x=$(""),n=$(null),c=$(0),b=$({}),y=$({}),F=$(""),M=$(""),q=$([]),S=$(!1),h=$(""),p=$({}),v=$(!1),I=$(!1),k=$([]),E=$(null),G=$({show:!1,message:"",type:"success"}),ke=D(()=>w.isDark),_e={minimap:{enabled:!1},fontSize:14,lineHeight:24,fontFamily:"'JetBrains Mono', 'Fira Code', Consolas, monospace",scrollBeyondLastLine:!1,automaticLayout:!0,padding:{top:16,bottom:16},wordWrap:"on",tabSize:2},H=D(()=>{const i=[],s=new Set;if(S.value&&Object.keys(p.value).length>0)for(const[f,C]of Object.entries(p.value))s.add(f),i.push({name:f,display_name:De(f),icon:ce(f),hasSchema:!0,fields:[],schemaFields:C});for(const f of q.value)s.has(f.name)||i.push({name:f.name,display_name:f.display_name,hasSchema:!1,fields:f.fields});return i}),A=D(()=>H.value.length>0&&c.value<H.value.length?H.value[c.value]??null:null),de=D(()=>{const i={};for(const[s,f]of Object.entries(y.value))if(typeof f=="object"&&f!==null)for(const[C,T]of Object.entries(f))i[C]=T,i[`${s}.${C}`]=T;return i}),le=D(()=>r.value==="source"?F.value!==M.value:JSON.stringify(y.value)!==JSON.stringify(b.value));pe(()=>{Q()});function $e(){le.value?confirm("有未保存的修改，确定要离开吗？")&&o.back():o.back()}function we(i){E.value&&Math.abs(i.deltaY)>Math.abs(i.deltaX)&&(i.preventDefault(),E.value.scrollLeft+=i.deltaY*.3)}function ue(i){le.value&&r.value!==i&&!confirm("切换模式将丢失未保存的修改，是否继续？")||(r.value=i,i==="visual"&&Q())}async function Q(){var i,s,f,C;g.value=!0,x.value="";try{const[T,L]=await Promise.all([He(),Ye(d.value)]);if((i=T.data)!=null&&i.configs){const u=T.data.configs.find(B=>B.path===d.value);u&&(n.value=u)}console.log(L),(s=L.data)!=null&&s.success&&((f=L.data)!=null&&f.parsed)?(b.value=L.data.parsed,y.value=JSON.parse(JSON.stringify(L.data.parsed)),F.value=L.data.content||"",M.value=L.data.content||"",await Ve(),await xe()):x.value=((C=L.data)==null?void 0:C.error)||L.error||"加载配置失败"}catch(T){x.value=T.message||"网络请求失败",console.error("加载配置失败:",T)}finally{g.value=!1}}async function Ve(){var s;const i=d.value.match(/plugins[\/\\]([^\/\\]+)[\/\\]config\.toml$/i);if(!i||!i[1]){S.value=!1,p.value={};return}h.value=i[1];try{const f=await jl(h.value);f.success&&((s=f.data)!=null&&s.schema)&&Object.keys(f.data.schema).length>0?(S.value=!0,p.value=f.data.schema):(S.value=!1,p.value={})}catch{S.value=!1,p.value={}}}async function xe(){var i,s;try{const f=await Xe(d.value);(i=f.data)!=null&&i.success&&((s=f.data)!=null&&s.sections)?q.value=f.data.sections:(console.error("加载配置模式失败:",f.error),re(b.value))}catch(f){console.error("加载配置模式失败:",f),re(b.value)}}function re(i){const s=[];for(const f in i){const C=i[f],T=[];if(typeof C=="object"&&!Array.isArray(C))for(const L in C){const u=C[L];let B="string";typeof u=="boolean"?B="boolean":typeof u=="number"?B=Number.isInteger(u)?"integer":"number":Array.isArray(u)&&(u.length>0&&typeof u[0]=="object"?B="array_of_objects":B="array"),T.push({key:L,full_key:`${f}.${L}`,type:B,value:u,description:void 0})}s.push({name:f,display_name:f.replace(/_/g," ").replace(/\b\w/g,L=>L.toUpperCase()),fields:T})}q.value=s}function Z(i){const s=i.split(".");let f=y.value;for(const C of s)if(f&&typeof f=="object"&&C in f)f=f[C];else return;return f}function ee(i,s){const f=i.split(".");let C=y.value;for(let L=0;L<f.length-1;L++){const u=f[L];u&&((!C[u]||typeof C[u]!="object")&&(C[u]={}),C=C[u])}const T=f[f.length-1];C&&T&&(C[T]=s)}function Ce(i){return Array.isArray(i)?i.map(s=>String(s)).join(`
`):String(i||"")}function Se(i,s){const f=s.split(`
`).map(C=>C.trim()).filter(C=>C);ee(i,f)}function Ie(i,s){const f=s==="integer"?parseInt(i):parseFloat(i);return isNaN(f)?0:f}function Fe(i,s){var f;return(f=y.value[i])==null?void 0:f[s]}function Ee(i,s,f){y.value[i]||(y.value[i]={}),y.value[i][s]=f}function Ne(i){if(!i.depends_on)return!0;const s=de.value[i.depends_on];return i.depends_value!==void 0?s===i.depends_value:!!s}function De(i){return i.replace(/_/g," ").replace(/\b\w/g,s=>s.toUpperCase())}async function je(){var i;if(!V.value){V.value=!0;try{let s;r.value==="source"?s=await Ze(d.value,F.value,!0):S.value&&h.value?s=await Ll(h.value,y.value,!0):s=await et(d.value,y.value,!0),s.success?(z("配置已保存","success"),(i=s.data)!=null&&i.backup_path&&console.log("备份已创建:",s.data.backup_path),await Q()):z(s.error||"保存失败","error")}catch(s){z(s.message||"保存请求失败","error"),console.error("保存失败:",s)}finally{V.value=!1}}}function Le(){z("TOML格式化功能开发中","error")}async function Be(){try{(await tt(()=>import("./index--izFXTDO.js").then(s=>s.i),[])).parse(F.value),z("TOML格式验证通过","success")}catch(i){z(`TOML格式错误: ${i.message}`,"error")}}function Oe(i){console.log("Monaco编辑器已加载")}function Me(i){r.value="source",z("已切换到源码模式，可以编辑复杂数组对象","success")}ye(v,i=>{i&&Te()});async function Te(){var i;I.value=!0;try{const s=await lt(d.value);s.success&&((i=s.data)!=null&&i.backups)&&(k.value=s.data.backups)}catch(s){console.error("获取备份列表失败:",s)}finally{I.value=!1}}async function Pe(i){if(confirm(`确定要还原到备份版本 "${i.name}" 吗？当前配置将被覆盖。`))try{const s=await st(d.value,i.name);s.success?(z("配置已从备份还原","success"),ae(),await Q()):z(s.error||"还原失败","error")}catch(s){z(s.message||"还原请求失败","error")}}function ae(){v.value=!1}function Ae(i){return i<1024?i+" B":i<1024*1024?(i/1024).toFixed(1)+" KB":(i/(1024*1024)).toFixed(1)+" MB"}function z(i,s="success"){G.value={show:!0,message:i,type:s},setTimeout(()=>{G.value.show=!1},3e3)}function ne(i){return{string:"文本",integer:"整数",number:"数字",boolean:"开关",array:"列表",array_of_objects:"对象数组",object:"对象"}[i]||i}function ce(i){const s={database:"database",api_providers:"cloud",personality:"psychology",permission:"lock",feature:"toggle_on",bot:"smart_toy",system:"settings",ui:"palette"};for(const[f,C]of Object.entries(s))if(i.toLowerCase().includes(f))return C;return"folder"}return(i,s)=>{var f,C,T,L;return l(),a("div",Bl,[e("header",Ol,[e("div",Ml,[e("button",{class:"m3-icon-button",onClick:$e,title:"返回"},[...s[4]||(s[4]=[e("span",{class:"material-symbols-rounded"},"arrow_back",-1)])]),e("div",Tl,[e("span",Pl,m(((f=n.value)==null?void 0:f.type)==="plugin"?"extension":((C=n.value)==null?void 0:C.type)==="model"?"psychology":"settings"),1)]),e("div",Al,[e("h1",null,m(((T=n.value)==null?void 0:T.display_name)||"配置编辑器"),1),e("p",Jl,[s[5]||(s[5]=e("span",{class:"material-symbols-rounded path-icon"},"folder",-1)),O(" "+m(d.value),1)]),(L=n.value)!=null&&L.description?(l(),a("p",Ul,m(n.value.description),1)):_("",!0)])]),e("div",Rl,[e("div",Wl,[e("button",{class:j(["segment",{active:r.value==="visual"}]),onClick:s[0]||(s[0]=u=>ue("visual")),disabled:g.value},[...s[6]||(s[6]=[e("span",{class:"material-symbols-rounded"},"grid_view",-1),O(" 可视化 ",-1)])],10,zl),e("button",{class:j(["segment",{active:r.value==="source"}]),onClick:s[1]||(s[1]=u=>ue("source")),disabled:g.value},[...s[7]||(s[7]=[e("span",{class:"material-symbols-rounded"},"code",-1),O(" 源码 ",-1)])],10,ql)]),e("button",{class:"m3-icon-button",onClick:s[2]||(s[2]=u=>v.value=!0),title:"备份历史",disabled:g.value},[...s[8]||(s[8]=[e("span",{class:"material-symbols-rounded"},"history",-1)])],8,Gl),e("button",{class:"m3-button filled",onClick:je,disabled:V.value||!le.value||g.value},[e("span",{class:j(["material-symbols-rounded",{spinning:V.value}])},m(V.value?"progress_activity":"save"),3),O(" "+m(V.value?"保存中...":"保存配置"),1)],8,Kl)])]),r.value==="visual"?(l(),a("div",{key:0,class:j(["visual-editor",{"schema-mode":S.value}])},[g.value?(l(),a("div",Hl,[...s[9]||(s[9]=[e("span",{class:"material-symbols-rounded spinning"},"progress_activity",-1),e("p",null,"加载配置中...",-1)])])):x.value?(l(),a("div",Yl,[s[11]||(s[11]=e("span",{class:"material-symbols-rounded error-icon"},"error",-1)),e("p",null,m(x.value),1),e("button",{class:"m3-button text",onClick:Q},[...s[10]||(s[10]=[e("span",{class:"material-symbols-rounded"},"refresh",-1),O(" 重试 ",-1)])])])):H.value.length>0?(l(),a(P,{key:2},[H.value.length>1?(l(),a("div",Xl,[e("div",{class:"nav-tabs",ref_key:"navTabsRef",ref:E,onWheel:we},[(l(!0),a(P,null,W(H.value,(u,B)=>{var me;return l(),a("button",{key:u.name,class:j(["nav-tab",{active:c.value===B,"has-schema":u.hasSchema}]),onClick:ln=>c.value=B},[e("span",Zl,m(u.icon||ce(u.name)),1),O(" "+m(u.display_name)+" ",1),e("span",ea,m(u.hasSchema?((me=u.schemaFields)==null?void 0:me.length)||0:u.fields.length),1),u.hasSchema?(l(),a("span",ta,[...s[12]||(s[12]=[e("span",{class:"material-symbols-rounded"},"auto_awesome",-1)])])):_("",!0)],10,Ql)}),128))],544)])):_("",!0),e("div",sa,[A.value?(l(),a("div",la,[e("div",aa,[e("div",na,[A.value.icon?(l(),a("span",oa,m(A.value.icon),1)):_("",!0),e("h3",null,m(A.value.display_name),1),e("span",ia,m(A.value.fields.length)+" 项配置",1),A.value.hasSchema?(l(),a("span",da,[...s[13]||(s[13]=[e("span",{class:"material-symbols-rounded"},"auto_awesome",-1),O(" Schema ",-1)])])):_("",!0)]),A.value.description?(l(),a("p",ua,m(A.value.description),1)):_("",!0)]),e("div",ra,[A.value.hasSchema&&A.value.schemaFields?(l(!0),a(P,{key:0},W(A.value.schemaFields,u=>(l(),a(P,{key:u.key},[!u.depends_on||Ne(u)?(l(),K(ve(ge),{key:0,field:u,"model-value":Fe(A.value.name,u.key),"all-values":de.value,"onUpdate:modelValue":B=>Ee(A.value.name,u.key,B)},null,8,["field","model-value","all-values","onUpdate:modelValue"])):_("",!0)],64))),128)):(l(!0),a(P,{key:1},W(A.value.fields,u=>(l(),a("div",{key:u.full_key,class:j(["m3-card field-card",{"inline-field":u.type==="boolean","has-description":!!u.description}])},[u.type==="boolean"?(l(),a(P,{key:0},[e("div",ca,[e("div",ma,[e("span",va,m(u.key),1),e("span",fa,m(ne(u.type)),1)]),u.description?(l(),a("div",pa,[s[14]||(s[14]=e("span",{class:"material-symbols-rounded desc-icon"},"info",-1)),e("span",null,m(u.description),1)])):_("",!0)]),e("label",ya,[e("input",{type:"checkbox",checked:!!Z(u.full_key),onChange:B=>ee(u.full_key,B.target.checked)},null,40,ba),s[15]||(s[15]=e("span",{class:"m3-switch-track"},[e("span",{class:"m3-switch-thumb"})],-1))])],64)):u.type==="array_of_objects"?(l(),a(P,{key:1},[e("div",ha,[e("span",ga,m(u.key),1),e("span",ka,m(ne(u.type)),1)]),u.description?(l(),a("div",_a,[s[16]||(s[16]=e("span",{class:"material-symbols-rounded desc-icon"},"info",-1)),e("span",null,m(u.description),1)])):_("",!0),e("div",$a,[e("div",wa,[s[17]||(s[17]=e("span",{class:"material-symbols-rounded"},"dataset",-1)),O(" 包含 "+m(u.items_count||0)+" 个项目 ",1)]),e("button",{class:"m3-button text small",onClick:B=>Me()},[...s[18]||(s[18]=[e("span",{class:"material-symbols-rounded"},"open_in_full",-1),O(" 在源码模式中编辑 ",-1)])],8,Va)])],64)):(l(),a(P,{key:2},[e("div",xa,[e("span",Ca,m(u.key),1),e("span",Sa,m(ne(u.type)),1)]),u.description?(l(),a("div",Ia,[s[19]||(s[19]=e("span",{class:"material-symbols-rounded desc-icon"},"info",-1)),e("span",null,m(u.description),1)])):_("",!0),u.type==="array"?(l(),a("div",Fa,[e("div",Ea,[e("textarea",{class:"m3-input array-textarea",value:Ce(Z(u.full_key)),onInput:B=>Se(u.full_key,B.target.value),placeholder:"每行一个值",rows:"5"},null,40,Na),s[20]||(s[20]=e("div",{class:"input-hint"},[e("span",{class:"material-symbols-rounded"},"info"),O(" 每行输入一个值 ")],-1))])])):u.type==="integer"||u.type==="number"?(l(),a("div",Da,[e("input",{type:"number",class:"m3-input",value:Z(u.full_key),onInput:B=>ee(u.full_key,Ie(B.target.value,u.type)),step:u.type==="number"?"0.01":"1"},null,40,ja)])):(l(),a("div",La,[e("input",{type:"text",class:"m3-input",value:Z(u.full_key),onInput:B=>ee(u.full_key,B.target.value),placeholder:`输入 ${u.key}`},null,40,Ba)]))],64))],2))),128))])])):_("",!0)])],64)):(l(),a("div",Oa,[...s[21]||(s[21]=[e("span",{class:"material-symbols-rounded empty-icon"},"description",-1),e("p",null,"该配置文件为空",-1)])]))],2)):(l(),a("div",Ma,[e("div",Ta,[e("div",Pa,[s[22]||(s[22]=e("span",{class:"material-symbols-rounded"},"description",-1)),e("span",Aa,m(d.value),1)]),e("div",Ja,[e("button",{class:"m3-button text small",onClick:Le,disabled:!F.value},[...s[23]||(s[23]=[e("span",{class:"material-symbols-rounded"},"format_align_left",-1),O(" 格式化 ",-1)])],8,Ua),e("button",{class:"m3-button text small",onClick:Be,disabled:!F.value},[...s[24]||(s[24]=[e("span",{class:"material-symbols-rounded"},"check_circle",-1),O(" 验证 ",-1)])],8,Ra)])]),e("div",Wa,[se(ve(at),{value:F.value,"onUpdate:value":s[3]||(s[3]=u=>F.value=u),language:"ini",theme:ke.value?"vs-dark":"vs",options:_e,onMount:Oe},null,8,["value","theme"])])])),v.value?(l(),a("div",{key:2,class:"m3-dialog-overlay",onClick:R(ae,["self"])},[e("div",za,[e("div",{class:"dialog-header"},[s[26]||(s[26]=e("div",{class:"dialog-title"},[e("span",{class:"material-symbols-rounded"},"history"),e("h3",null,"备份管理")],-1)),e("button",{class:"m3-icon-button",onClick:ae},[...s[25]||(s[25]=[e("span",{class:"material-symbols-rounded"},"close",-1)])])]),e("div",qa,[I.value?(l(),a("div",Ga,[...s[27]||(s[27]=[e("span",{class:"material-symbols-rounded spinning"},"progress_activity",-1),e("p",null,"加载备份列表...",-1)])])):k.value.length?(l(),a("div",Ka,[(l(!0),a(P,null,W(k.value,u=>(l(),a("div",{class:"backup-item",key:u.path},[s[32]||(s[32]=e("div",{class:"backup-icon"},[e("span",{class:"material-symbols-rounded"},"save")],-1)),e("div",Ha,[e("span",Ya,m(u.name),1),e("span",Xa,[s[28]||(s[28]=e("span",{class:"material-symbols-rounded meta-icon"},"schedule",-1)),O(" "+m(u.created_at)+" ",1),s[29]||(s[29]=e("span",{class:"separator"},"·",-1)),s[30]||(s[30]=e("span",{class:"material-symbols-rounded meta-icon"},"storage",-1)),O(" "+m(Ae(u.size)),1)])]),e("div",Qa,[e("button",{class:"m3-button text small",onClick:B=>Pe(u)},[...s[31]||(s[31]=[e("span",{class:"material-symbols-rounded"},"restore",-1),O(" 还原 ",-1)])],8,Za)])]))),128))])):(l(),a("div",en,[...s[33]||(s[33]=[e("span",{class:"material-symbols-rounded empty-icon"},"history_toggle_off",-1),e("p",null,"暂无备份记录",-1),e("p",{class:"empty-hint"},"保存配置时将自动创建备份",-1)])]))])])])):_("",!0),se(ie,{name:"toast"},{default:Y(()=>[G.value.show?(l(),a("div",{key:0,class:j(["m3-snackbar",G.value.type])},[e("span",tn,m(G.value.type==="success"?"check_circle":"error"),1),O(" "+m(G.value.message),1)],2)):_("",!0)]),_:1})])}}}),on=U(sn,[["__scopeId","data-v-79ac20aa"]]);export{on as default};
