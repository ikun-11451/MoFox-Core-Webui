import{d as Z,r as g,a as F,u as ee,b as te,c as s,n as M,e,f as r,T as v,w as c,g as d,F as W,h as Y,t as b,i as N,j as q,k as ae,s as oe,l as H,o,m as T,_ as X,p as O,q as S,v as se,x as ne,y as ie,z as le,A as ce}from"./index-Dz5dMUCJ.js";import{s as A,a as U,b as G}from"./dialog-Ck3E8B9J.js";import"./ConfirmDialog-DKI8_ff0.js";import"./iconify-BDIAN8Vl.js";const V=Z("ui",()=>{const y=g(!1);function u(){y.value=!y.value}function w(){y.value=!0}function m(){y.value=!1}return{isDocOpen:y,toggleDoc:u,openDoc:w,closeDoc:m}}),re={class:"sidebar-header"},de={class:"logo-wrapper"},ue={key:0,class:"logo-text"},me={class:"sidebar-nav"},pe={class:"nav-section"},he={key:0,class:"nav-section-title"},ve={key:0,class:"nav-group"},_e=["onClick","title"],fe={class:"nav-icon-wrapper"},be={class:"material-symbols-rounded nav-icon"},ge={key:0,class:"nav-text"},ye={key:0,class:"material-symbols-rounded nav-arrow"},we={key:0,class:"nav-children"},ke=["onClick","title"],xe={class:"nav-icon-wrapper"},Ce={class:"material-symbols-rounded nav-icon"},De={class:"nav-text"},Be=["onClick","title"],Se={class:"nav-icon-wrapper"},Ie={class:"material-symbols-rounded nav-icon"},ze={key:0,class:"nav-text"},Me=["onClick","title"],Le={class:"nav-icon-wrapper"},$e={class:"material-symbols-rounded nav-icon"},Ee={key:0,class:"nav-text"},Re={class:"sidebar-footer"},Te={key:0},We={key:0},Fe={key:0},Xe=["title"],Ye={class:"material-symbols-rounded footer-icon collapse-icon"},Ae={key:0},Ue=F({__name:"Sidebar",setup(y){const u=N(),w=q(),m=ee(),f=V(),t=g(!0),p=te({config:!0,"ai-management":!0,"ui-settings":!0,"log-management":!0}),k=async()=>{if(await A({title:"重启 Bot",message:"确定要重启 MoFox Bot 吗？这将中断当前的所有连接。",confirmText:"重启"}))try{await ae(),U("Bot 重启指令已发送")}catch(n){G("重启失败: "+n)}},C=async()=>{if(await A({title:"关闭 Bot",message:"确定要关闭 MoFox Bot 吗？WebUI 也将失去连接。",confirmText:"关闭"}))try{await oe(),U("Bot 关闭指令已发送")}catch(n){G("关闭失败: "+n)}},D=()=>{m.logout(),w.push("/login")},B=[{name:"仪表盘",path:"/dashboard",icon:"dashboard"},{name:"UI 聊天室",path:"/dashboard/chatroom",icon:"forum"},{name:"实时消息",path:"/dashboard/live-chat",icon:"chat"},{name:"配置管理",path:"/dashboard/config",icon:"settings",key:"config",children:[{name:"机器人配置",path:"/dashboard/bot-config",icon:"smart_toy"},{name:"模型配置",path:"/dashboard/model-config",icon:"psychology"},{name:"模型统计",path:"/dashboard/model-stats",icon:"bar_chart"},{name:"插件配置",path:"/dashboard/plugin-config",icon:"extension"}]},{name:"智能管理",path:"/dashboard/ai-management",icon:"psychology_alt",key:"ai-management",children:[{name:"关系管理",path:"/dashboard/relationship",icon:"group"},{name:"表达方式",path:"/dashboard/expression",icon:"record_voice_over"},{name:"插件管理",path:"/dashboard/plugin-manage",icon:"deployed_code"},{name:"插件市场",path:"/dashboard/marketplace",icon:"storefront"},{name:"表情管理",path:"/dashboard/emoji-manager",icon:"insert_emoticon"}]},{name:"UI 设置",path:"/dashboard/ui-settings",icon:"tune",key:"ui-settings",children:[{name:"风格与壁纸",path:"/dashboard/theme",icon:"palette"}]},{name:"日志管理",path:"/dashboard/log-management",icon:"description",key:"log-management",children:[{name:"日志查看器",path:"/dashboard/log-viewer",icon:"article"},{name:"实时日志",path:"/dashboard/live-log",icon:"sensors"}]},{name:"更新管理",path:"/dashboard/git-update",icon:"system_update"},{name:"GitHub 仓库",path:"/dashboard/github",icon:"code"},{name:"官方文档",path:"",icon:"menu_book",action:()=>f.toggleDoc(),isActive:()=>f.isDocOpen}],L=()=>{t.value=!t.value},$=i=>{t.value?(t.value=!1,p[i]=!0):p[i]=!p[i]},x=i=>i==="/dashboard"?u.path==="/dashboard"||u.path==="/dashboard/":u.path===i||u.path.startsWith(i+"/"),E=i=>i.children?i.children.some(n=>x(n.path)):x(i.path);return(i,n)=>{const I=H("router-link");return o(),s("aside",{class:M(["sidebar",{collapsed:t.value}])},[e("div",re,[e("div",de,[n[0]||(n[0]=e("div",{class:"logo-icon"},[e("span",{class:"material-symbols-rounded"},"smart_toy")],-1)),r(v,{name:"fade"},{default:c(()=>[t.value?d("",!0):(o(),s("span",ue,"MoFox"))]),_:1})])]),e("nav",me,[e("div",pe,[r(v,{name:"fade"},{default:c(()=>[t.value?d("",!0):(o(),s("span",he,"菜单"))]),_:1}),(o(),s(W,null,Y(B,a=>(o(),s(W,{key:a.name},[a.children&&a.key?(o(),s("div",ve,[e("div",{class:M(["nav-item-content nav-group-header",{active:E(a),expanded:p[a.key]}]),onClick:_=>$(a.key),title:a.name},[e("div",fe,[e("span",be,b(a.icon),1)]),r(v,{name:"slide-fade"},{default:c(()=>[t.value?d("",!0):(o(),s("span",ge,b(a.name),1))]),_:2},1024),r(v,{name:"fade"},{default:c(()=>[t.value?d("",!0):(o(),s("span",ye,b(p[a.key]?"expand_less":"expand_more"),1))]),_:2},1024)],10,_e),r(v,{name:"expand"},{default:c(()=>[p[a.key]&&!t.value?(o(),s("div",we,[(o(!0),s(W,null,Y(a.children,_=>(o(),T(I,{key:_.path,to:_.path,custom:""},{default:c(({navigate:R})=>[e("div",{class:"nav-item nav-child-item",onClick:R,title:_.name},[e("div",{class:M(["nav-item-content",{active:x(_.path)}])},[e("div",xe,[e("span",Ce,b(_.icon),1)]),e("span",De,b(_.name),1)],2)],8,ke)]),_:2},1032,["to"]))),128))])):d("",!0)]),_:2},1024)])):a.action?(o(),s("div",{key:1,class:"nav-item",onClick:a.action,title:a.name},[e("div",{class:M(["nav-item-content",{active:a.isActive?a.isActive():!1}])},[e("div",Se,[e("span",Ie,b(a.icon),1)]),r(v,{name:"slide-fade"},{default:c(()=>[t.value?d("",!0):(o(),s("span",ze,b(a.name),1))]),_:2},1024)],2)],8,Be)):(o(),T(I,{key:2,to:a.path,custom:""},{default:c(({navigate:_})=>[e("div",{class:"nav-item",onClick:_,title:a.name},[e("div",{class:M(["nav-item-content",{active:x(a.path)}])},[e("div",Le,[e("span",$e,b(a.icon),1)]),r(v,{name:"slide-fade"},{default:c(()=>[t.value?d("",!0):(o(),s("span",Ee,b(a.name),1))]),_:2},1024)],2)],8,Me)]),_:2},1032,["to"]))],64))),64))])]),e("div",Re,[e("button",{class:"footer-button",onClick:k,title:"重启 Bot"},[n[1]||(n[1]=e("span",{class:"material-symbols-rounded footer-icon"},"refresh",-1)),r(v,{name:"slide-fade"},{default:c(()=>[t.value?d("",!0):(o(),s("span",Te,"重启 Bot"))]),_:1})]),e("button",{class:"footer-button",onClick:C,title:"关闭 Bot"},[n[2]||(n[2]=e("span",{class:"material-symbols-rounded footer-icon"},"power_settings_new",-1)),r(v,{name:"slide-fade"},{default:c(()=>[t.value?d("",!0):(o(),s("span",We,"关闭 Bot"))]),_:1})]),e("button",{class:"footer-button",onClick:D,title:"退出登录"},[n[3]||(n[3]=e("span",{class:"material-symbols-rounded footer-icon"},"logout",-1)),r(v,{name:"slide-fade"},{default:c(()=>[t.value?d("",!0):(o(),s("span",Fe,"退出登录"))]),_:1})]),e("button",{class:"footer-button collapse-button",onClick:L,title:t.value?"展开侧边栏":"收起侧边栏"},[e("span",Ye,b(t.value?"last_page":"first_page"),1),r(v,{name:"slide-fade"},{default:c(()=>[t.value?d("",!0):(o(),s("span",Ae,"收起菜单"))]),_:1})],8,Xe)])],2)}}}),Ge=X(Ue,[["__scopeId","data-v-e855341d"]]),Ne={class:"actions"},qe={class:"doc-content"},He={key:0,class:"iframe-mask"},Oe=F({__name:"FloatingDoc",setup(y){const u=V(),w=g(null),m=g(window.innerWidth-450),f=g(80),t=g(400),p=g(600),k=g(!1),C=g(!1);let D=0,B=0,L=0,$=0,x=0,E=0;const i=h=>{h.target.closest(".action-btn")||(k.value=!0,D=h.clientX,B=h.clientY,L=m.value,$=f.value,document.addEventListener("mousemove",n),document.addEventListener("mouseup",I))},n=h=>{if(!k.value)return;const l=h.clientX-D,z=h.clientY-B,J=L+l,K=$+z,P=window.innerWidth-t.value,Q=window.innerHeight-p.value;m.value=Math.max(0,Math.min(J,P)),f.value=Math.max(0,Math.min(K,Q))},I=()=>{k.value=!1,document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",I)},a=h=>{C.value=!0,D=h.clientX,B=h.clientY,x=t.value,E=p.value,document.addEventListener("mousemove",_),document.addEventListener("mouseup",R)},_=h=>{if(!C.value)return;const l=h.clientX-D,z=h.clientY-B;t.value=Math.max(300,x+l),p.value=Math.max(200,E+z)},R=()=>{C.value=!1,document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",R)},j=()=>{window.open("https://docs.mofox-sama.com/","_blank"),u.closeDoc()};return O(()=>{window.innerWidth<800?(m.value=20,t.value=window.innerWidth-40):m.value=window.innerWidth-450}),(h,l)=>(o(),T(v,{name:"pop"},{default:c(()=>[S(u).isDocOpen?(o(),s("div",{key:0,class:"floating-doc",style:se({left:m.value+"px",top:f.value+"px",width:t.value+"px",height:p.value+"px"}),ref_key:"windowRef",ref:w},[e("div",{class:"doc-header",onMousedown:i},[l[3]||(l[3]=e("div",{class:"drag-handle"},[e("span",{class:"material-symbols-rounded drag-icon"},"drag_indicator"),e("span",{class:"title"},"官方文档")],-1)),e("div",Ne,[e("button",{class:"action-btn",onClick:j,title:"在新窗口打开"},[...l[1]||(l[1]=[e("span",{class:"material-symbols-rounded"},"open_in_new",-1)])]),e("button",{class:"action-btn close-btn",onClick:l[0]||(l[0]=(...z)=>S(u).closeDoc&&S(u).closeDoc(...z)),title:"关闭"},[...l[2]||(l[2]=[e("span",{class:"material-symbols-rounded"},"close",-1)])])])],32),e("div",qe,[l[4]||(l[4]=e("iframe",{src:"https://docs.mofox-sama.com/",frameborder:"0"},null,-1)),k.value||C.value?(o(),s("div",He)):d("",!0)]),e("div",{class:"resize-handle",onMousedown:ne(a,["stop"])},[...l[5]||(l[5]=[e("span",{class:"material-symbols-rounded"},"drag_handle",-1)])],32)],4)):d("",!0)]),_:1}))}}),Ve=X(Oe,[["__scopeId","data-v-16f33d29"]]),je={class:"dashboard-wrapper"},Je={class:"wallpaper-layer"},Ke=["src"],Pe={class:"main-layout"},Qe={class:"dashboard-content"},Ze=F({__name:"Dashboard",setup(y){const u=q(),w=N(),m=ie();return O(()=>{if(w.path==="/initialization")return;const f=async()=>{try{!await le()&&w.path!=="/initialization"&&u.replace("/initialization")}catch(t){console.error("初始化状态检查失败:",t)}};"requestIdleCallback"in window?requestIdleCallback(()=>f(),{timeout:250}):setTimeout(f,100)}),(f,t)=>{const p=H("router-view");return o(),s("div",je,[e("div",Je,[S(m).wallpaper&&S(m).wallpaperType==="video"?(o(),s("video",{key:0,class:"wallpaper-video",controlsList:"nodownload noplaybackrate",src:S(m).wallpaper,autoplay:"",loop:"",muted:"",playsinline:""},null,8,Ke)):d("",!0)]),r(Ge),e("div",Pe,[e("main",Qe,[r(p,null,{default:c(({Component:k})=>[r(v,{name:"page-fade",mode:"out-in"},{default:c(()=>[(o(),T(ce(k)))]),_:2},1024)]),_:1})])]),r(Ve)])}}}),st=X(Ze,[["__scopeId","data-v-9846ccb5"]]);export{st as default};
